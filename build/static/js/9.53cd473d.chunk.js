(this.webpackJsonpcalcetto=this.webpackJsonpcalcetto||[]).push([[9],{210:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"d",(function(){return p})),a.d(t,"c",(function(){return d}));a(43),a(209),a(55),a(0),a(201);var n,r,o,i,c=a(227),l=a(214),s={Portiere:"Portiere",Attaccante:"Attaccante",Master:"Master"};function u(){n(""),r(""),o(""),i("")}t.b=function(e){return[{dataField:"id",text:"ID",editable:!1,headerStyle:function(e,t){return{width:"3%"}}},{dataField:"name",text:"Nome",headerClasses:"player-table-header-element",autoSelectText:!0,headerStyle:function(t,a){return{width:e?"16%":"25%"}},filter:Object(c.textFilter)({placeholder:"Filtra...",getFilter:function(e){return n=e}})},{dataField:"surname",text:"Cognome",headerClasses:"player-table-header-element",autoSelectText:!0,headerStyle:function(t,a){return{width:e?"16%":"25%"}},filter:Object(c.textFilter)({placeholder:"Filtra...",getFilter:function(e){return r=e}})},{dataField:"alias",text:"Alias",headerClasses:"player-table-header-element",headerStyle:function(t,a){return{width:e?"17%":"25%"}},autoSelectText:!0,filter:Object(c.textFilter)({placeholder:"Filtra...",getFilter:function(e){return o=e}})},{dataField:"role",text:"Roulo",headerClasses:"player-table-header-element",headerStyle:function(t,a){return{width:"".concat(e?"11":"15","%")}},filter:Object(c.selectFilter)({placeholder:"Filtra...",options:s,getFilter:function(e){return i=e}}),editor:{type:l.Type.SELECT,getOptions:function(e){return[{value:"Portiere",label:"Portiere"},{value:"Attaccante",label:"Attaccante"},{value:"Master",label:"Master"}]}}},{dataField:"email",text:"Email",headerStyle:function(e,t){return{width:"20%"}},headerClasses:"player-table-header-element",autoSelectText:!0,hidden:!e},{dataField:"phone",headerStyle:function(e,t){return{width:"10%"}},text:"Telefono",headerClasses:"player-table-header-element",autoSelectText:!0,hidden:!e},{dataField:"match_played",text:"Partite Giocate",hidden:!0},{dataField:"match_won",text:"Vittorie",hidden:!0},{dataField:"total_score",text:"Punteggio",hidden:!0}]};function p(e){return e?e.alias?e.alias:e.surname?"".concat(e.name," - ").concat(e.surname):e.name:""}function d(e){return{id:null,name:"",surname:"",alias:"",label:e||"",role:"Portiere",email:"",phone:"",match_played:0,match_won:0,total_score:0,editable:!1}}},230:function(e,t,a){"use strict";a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return b})),a.d(t,"e",(function(){return v})),a.d(t,"c",(function(){return w})),a.d(t,"d",(function(){return E})),a.d(t,"f",(function(){return j}));var n=a(209),r=a(43),o=a.n(r),i=a(55),c=a(0),l=a.n(c),s=a(214),u=a.n(s),p=a(29),d=a(224),m=a(210),f=a(239),g=Object(f.a)(),h=l.a.forwardRef((function(e,t){var a=Object(c.useState)(),n=Object(p.a)(a,2),r=n[0],o=n[1],i=e.row,s=e.columnIndex,u=e.id,f=e.onUpdate,h=e.onSelect,y=e.options;return l.a.createElement(d.a,{components:g,options:y,onChange:function(e){e.pairId=u,o(e);var t=Object(m.d)(e);f(t),h(e,i.id,s)},value:r,placeholder:"Cerca...",isSearchable:!0,isClearable:!0})})),y=function(e,t){return[{dataField:"id",text:"ID",editable:!1,hidden:!0,align:function(){return"center"}},{dataField:"rowNumber",text:"ID",editable:!1,align:function(){return"center"}},{dataField:"player1.alias",text:"Giocatore 1",align:function(){return"center"},editorRenderer:function(a,n,r,o,i,c){return l.a.createElement(h,Object.assign({},a,{id:c,row:r,rowIndex:i,columnIndex:c,value:n,onSelect:e,options:t}))},headerStyle:function(e,t){return{width:"20%"}}},{dataField:"player2.alias",text:"Giocatore 2",align:function(){return"center"},editorRenderer:function(a,n,r,o,i,c){return l.a.createElement(h,Object.assign({},a,{id:c,row:r,rowIndex:i,columnIndex:c,value:n,onSelect:e,options:t}))},headerStyle:function(e,t){return{width:"20%"}}},{dataField:"pairAlias",text:"Alias Coppia",headerStyle:function(e,t){return{width:"25%"}}},{dataField:"stage1Name",text:"Nome girone",align:function(){return"center"},headerStyle:function(e,t){return{width:"10%"}},editor:{type:s.Type.SELECT,options:"abcdefghijklmnopqrstuvwxyz".toUpperCase().split("").map((function(e){return{value:e,label:e}}))}},{dataField:"paid1",text:"Pagato 1",align:function(){return"center"},headerStyle:function(e,t){return{width:"7,5%"}},editor:{type:s.Type.CHECKBOX,value:"Si:No"},style:function(e,t,a,n){if("Si"!==e)return{backgroundColor:"#ffbf47"}}},{dataField:"paid2",text:"Pagato 2",align:function(){return"center"},headerStyle:function(e,t){return{width:"7,5%"}},editor:{type:s.Type.CHECKBOX,value:"Si:No"},style:function(e,t,a,n){if("Si"!==e)return{backgroundColor:"#ffbf47"}}}]},b=function(e){return u()({mode:e?"click":"none",blurToSave:!0,afterSaveCell:function(e,t,a,n){"player1.alias"!==n.dataField&&"player2.alias"!==n.dataField&&Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 2:return t=e.sent,e.next=5,t.json();case 5:case"end":return e.stop()}}),e)})))()}})};function v(){return{id:null,rowNumber:null,tId:null,player1:Object(m.c)(),player2:Object(m.c)(),pairAlias:"",stage1Name:"",paid1:"No",paid2:"No"}}var w=function(){var e=Object(i.a)(o.a.mark((function e(t){var a,r,i,c,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/pair/list/?tId=".concat(t),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:return a=e.sent,e.next=5,a.json();case 5:return r=e.sent,e.next=8,fetch(t?"/api/v1/player/list/".concat(t):"/api/v1/player/list",{method:"GET",headers:{"Content-Type":"application/json"}});case 8:return a=e.sent,e.next=11,a.json();case 11:return i=e.sent,c=[].concat(Object(n.a)(i),[Object(m.c)("Nessun Giocatore")]),e.next=15,fetch("/api/v1/tournament/".concat(t),{method:"GET",headers:{"Content-Type":"application/json"}});case 15:return a=e.sent,e.next=18,a.json();case 18:return l=e.sent,e.abrupt("return",{rows:r,players:c,tournament:l});case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(e,t){Object(i.a)(o.a.mark((function a(){var n,r;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("/api/v1/pair/list/?tId=".concat(t),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:return n=a.sent,a.next=5,n.json();case 5:r=a.sent,e(r);case 7:case"end":return a.stop()}}),a)})))()};function j(e){return console.log("valueFormatter : ",e),e.pairAlias&&""!==e.pairAlias?"".concat(e.pairAlias," ( ").concat(e.id," )"):function(e){console.log("createAlias : ",e);var t="".concat(e.rowNumber," : "),a=e.player1,n=e.player2,r=e.id;return t+=a.alias?a.alias:a.name,t+=n.alias,t+=" ( ".concat(r," )")}(e)}},238:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n={New:"new",PairsSelection:"PairsSelection",Stage1:"Stage1",Stage2:"Stage2"}},318:function(e,t,a){},336:function(e,t,a){"use strict";a.r(t);var n=a(209),r=a(43),o=a.n(r),i=a(55),c=a(29),l=a(0),s=a.n(l),u=a(237),p=a(215),d=a(327),m=a(335),f=a(328),g=a(323),h=a(216),y=a(201),b=a(231),v=a.n(b),w=a(230),E=a(210),j=a(13),x=function(e){var t=e.tournament;return t?s.a.createElement("h3",null,s.a.createElement("p",null,s.a.createElement("b",null,'Torneo "',s.a.createElement("strong",null,null===t||void 0===t?void 0:t.name.toUpperCase()),'" ( ',null===t||void 0===t?void 0:t.id," )",s.a.createElement("small",null," - ",null===t||void 0===t?void 0:t.progress)))):null},O=a(38),S=function(e){var t=e.addRow,a=e.optionsLength,n=a-1,r=n<8?8-n:0;return a?n>=8?s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null," Aggiungi le coppie per questo torneo..."),s.a.createElement(y.a,{variant:"success",onClick:t},"Aggiungi Coppia")):s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,"Ci sono solo ",n," giocatori definiti ma devono essercene almeno 8 per poter formare un torneo."),s.a.createElement("p",null,1===r?"Devi creare un altro giocatore...":"Devi creare almeno altri ".concat(r)),s.a.createElement(O.b,{to:"/player"},s.a.createElement(y.a,{variant:"success"},"Gestione Giocatori"))):null},C=a(94),T=(a(318),a(238)),N=a(33);t.default=function(){var e=Object(j.i)().tId;console.log("render pairs table : ",e);var t=Object(j.g)(),a=Object(l.useState)({state:!1,message:"Caricamento"}),r=Object(c.a)(a,2),b=r[0],O=r[1],k={message:"",type:"success"},F=Object(l.useState)(k),A=Object(c.a)(F,2),I=A[0],P=A[1],z=Object(l.useState)({tournament:null,rows:[],players:[]}),G=Object(c.a)(z,2),R=G[0],D=G[1],J=Object(l.useState)([]),M=Object(c.a)(J,2),L=M[0],_=M[1],H=Object(l.useState)(0),U=Object(c.a)(H,2),q=U[0],B=U[1],K=Object(l.useState)(0),V=Object(c.a)(K,2),X=V[0],Q=V[1];function W(e){O({state:!1,message:e}),P({message:e,type:"danger"}),setTimeout((function(){return P(k)}),5e3)}function Y(e){O({state:!1,message:e}),P({message:e,type:"success"}),setTimeout((function(){return P(k)}),5e3)}function Z(e){return $.apply(this,arguments)}function $(){return($=Object(i.a)(o.a.mark((function t(a){var r,i,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,O({state:!0,message:"Aggiunta riga in corso"}),(r=Object(w.e)()).tId=e,t.next=6,fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 6:return i=t.sent,t.next=9,i.json();case 9:c=t.sent,r.id=c.id,r.rowNumber=a||R.rows.length+1,D((function(e){return{tournament:e.tournament,rows:[r].concat(Object(n.a)(e.rows)),players:e.players}})),Y("Riga aggiunta"),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),W("Errore aggiunta riga");case 19:case"end":return t.stop()}}),t,null,[[0,16]])})))).apply(this,arguments)}function ee(){return te.apply(this,arguments)}function te(){return(te=Object(i.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=R.rows.length+1,a=0;case 2:if(!(a<X)){e.next=9;break}return e.next=5,Z(t);case 5:t++;case 6:a++,e.next=2;break;case 9:Q(0);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(){return ne.apply(this,arguments)}function ne(){return(ne=Object(i.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,O({state:!0,message:L.length>1?"Cancellazione righe in corso":"Cancellazione riga in corso"}),t=[],L.forEach((function(e){e.player1.id&&t.push(e.player1),e.player2.id&&t.push(e.player2)})),t&&D((function(e){return{tournament:e.tournament,rows:e.rows,players:[].concat(t,Object(n.a)(e.players)).sort((function(e,t){return e.alias.localeCompare(t.alias)}))}})),e.next=7,fetch("/api/v1/pair",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});case 7:return a=e.sent,e.next=10,a.json();case 10:D((function(e){return{tournament:e.tournament,rows:e.rows.filter((function(e){return!L.find((function(t){return t.id===e.id}))})),players:e.players}})),Y(L.length>1?"Righe cancellate":"Riga cancellata"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),W("Errore cancellazione riga");case 17:_([]);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function re(e,t){e&&e.id?t.id?D((function(a){return{tournament:a.tournament,rows:a.rows,players:[].concat(Object(n.a)(a.players.filter((function(e){return e.id!==t.id}))),[e]).sort((function(e,t){return e.alias.localeCompare(t.alias)}))}})):D((function(t){return{tournament:t.tournament,rows:t.rows,players:[].concat(Object(n.a)(t.players),[e]).sort((function(e,t){return e.alias.localeCompare(t.alias)}))}})):t.id&&D((function(e){return{tournament:e.tournament,rows:e.rows,players:e.players.filter((function(e){return e.id!==t.id}))}}))}Object(l.useEffect)((function(){Object(i.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=D,t.next=3,Object(w.c)(e);case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 5:case"end":return t.stop()}}),t)})))()}),[e]);var oe=function(e,t,a){var n=R.rows.map((function(n){if(n.id===t){var r=n;return 1===a?e.id&&r.player2&&r.player2.id===e.id?(r.player1=Object(E.c)(),W("Attenzione : Non puoi selezionare lo stesso giocare ! ")):(re(r.player1,e),r.player1=e):e.id&&r.player1&&r.player1.id===e.id?(r.player2=Object(E.c)(),W("Attenzione : Non puoi selezionare lo stesso giocare ! ")):(re(r.player2,e),r.player2=e),fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),r}return n}));D((function(e){return{tournament:e.tournament,rows:n,players:e.players}}))},ie=function(e,t){_((function(a){var r=!!a.find((function(t){return t.id===e.id}));return t?r?a:[e].concat(Object(n.a)(a)):r?a.filter((function(t){return t.id!==e.id})):a}))},ce=function(a){if(e||(W("Id torneo mancante. Verrai inviato alla Home tra 5 secondi...."),setTimeout((function(){return t.push("/")}),5e3)),R.rows.length<4)W("Numero di coppie insufficente. Devi formare almeno 4 coppie");else{var n=R.rows.filter((function(e){return!e.stage1Name||""===e.stage1Name})).map((function(e){return e.rowNumber}));if(0===n.length){var r=R.rows.filter((function(e){return null===e.player1.id||null===e.player2.id})).map((function(e){return e.rowNumber}));if(0===r.length){var o=[],i=R.rows.reduce((function(e,t){return t.stage1Name in e?e[t.stage1Name]++:e[t.stage1Name]=1,e}),{});for(var c in i)i[c]<=3&&o.push(c);o.length>0?W(1===o.length?"Il torneo ".concat(o," deve contenere almeno ").concat(4," coppie"):"I torneI ".concat(o," devono contenere almeno ").concat(4," coppie")):(R.tournament.progress=T.a.Stage1,fetch("/api/tournament",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R.tournament)}),t.push("/stage1/".concat(e)))}else W("Assegna  i giocatori ".concat(1===r.length?"alla riga ":"alle righe "," ").concat(r," per procedere "))}else W("Assegna  ".concat(1===n.length?"la riga ":"le righe "," ").concat(n," ad un girone per procedere "))}};function le(){t.push("/")}var se={mode:"checkbox",onSelect:ie,onSelectAll:function(e,t){return t.forEach((function(t){return ie(t,e)}))},style:{backgroundColor:"#c8e6c9"}};function ue(){return pe.apply(this,arguments)}function pe(){return(pe=Object(i.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,O({state:!0,message:"Cancellazione in corso"}),t.next=4,fetch("/api/stage1",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({tId:e})});case 4:return a=t.sent,t.next=7,a.json();case 7:R.tournament.progress=T.a.PairsSelection,fetch("/api/tournament",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R.tournament)}),Y("Cancellazione completata"),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),W("Errore cancellazione Fase 1");case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))).apply(this,arguments)}function de(){return me.apply(this,arguments)}function me(){return(me=Object(i.a)(o.a.mark((function e(){var t,a,n,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q){e.next=3;break}return W("Specificare il numero di gironi da assegnare"),e.abrupt("return");case 3:for(r in O({state:!0,message:"Aggiornamento in corso "}),t=0,a="abcdefghijklmnopqrstuvwxyz".toUpperCase().split(""),n=[],R.rows){i=R.rows[r],t==q&&(t=0),i.stage1Name=a[t],t++;try{fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),n.push(i)}catch(o){W("Errore"),n.push(i)}}Y("Gironi assegnati correttamente"),D((function(e){return{tournament:e.tournament,rows:n,players:e.players}}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fe=Math.floor(R.players.length-1-R.rows.reduce((function(e,t){return t.player1||t.player2?t.player1&&t.player2?t.player1.id||t.player2.id?t.player1.id&&t.player2.id?e:e+1:e+2:e+1:e+2}),0))/2,ge=!(L.length>0)||"Stage1"===R.tournament.progress||"Stage2"===R.tournament.progress,he="";return he=L.length>0?"Stage1"===R.tournament.progress||"Stage2"===R.tournament.progress?"Devi prima resettare i gironi per poter cancellare delle coppie":"Cancella le coppie selezionate":"Seleziona almeno una riga",s.a.createElement(N.a.Consumer,null,(function(e){var t=Object(c.a)(e,1)[0];return s.a.createElement(u.a,null,s.a.createElement(C.b,{show:b.state,message:b.message}),s.a.createElement(p.a,{style:{margin:"10px"},md:{span:1}},s.a.createElement(u.a,null,s.a.createElement(d.a,null,s.a.createElement(d.a.Item,{action:!0,variant:"primary",onClick:ce},"Prosegui"),s.a.createElement(d.a.Item,{action:!0,variant:"secondary",onClick:le},"Home"),s.a.createElement(d.a.Item,{action:!0,variant:"success",onClick:function(){return Z()},disabled:fe<=0||!Object(N.c)(t)},"Aggiungi Coppia"),s.a.createElement(m.a,{placement:"right",key:"right",overlay:s.a.createElement(f.a,null,he)},s.a.createElement("span",{className:"d-inline-block",onClick:ae},s.a.createElement(d.a.Item,{action:!0,variant:"danger",style:{pointerEvents:"none"},disabled:ge||!Object(N.c)(t)},"Elimina Coppia ",ge))),s.a.createElement(d.a.Item,{action:!0,variant:"danger",onClick:ue,disabled:!Object(N.c)(t)},"Reset gironi")))),s.a.createElement(p.a,{style:{margin:"10px"}},s.a.createElement(u.a,{style:{display:Object(N.c)(t)?"flex":"none"}},s.a.createElement(g.a,{onChange:function(e){return B(e.target.value)}},s.a.createElement(g.a.Prepend,null,s.a.createElement(g.a.Text,null,"Assegna gironi automaticamente")),s.a.createElement(h.a,{placeholder:R.rows.length<4?"Inserisci almeno 4 coppie":"Numero di gironi ( max ".concat(Math.floor(R.rows.length/4)," )"),"aria-label":"Numero di gironi",disabled:R.rows.length<4}),s.a.createElement(g.a.Append,null,s.a.createElement(y.a,{variant:"primary",onClick:de,disabled:!q||q>Math.floor(R.rows.length/4)||R.rows.length<4},"Esegui"))),s.a.createElement(g.a,{onChange:function(e){return Q(e.target.value)}},s.a.createElement(g.a.Prepend,null,s.a.createElement(g.a.Text,null,"Aggiunti N nuove coppie")),s.a.createElement(h.a,{disabled:fe<=0,placeholder:fe<=0?"Numero massimo di coppie gia creato sulla base del numero di giocatori disponibili":"Numero di coppie da aggiungere ( max ".concat(fe," )"),"aria-label":"Numero di coppie",value:X||""}),s.a.createElement(g.a.Append,null,s.a.createElement(y.a,{variant:"primary",onClick:function(e){return Q(fe)},disabled:X>fe},"Max"),s.a.createElement(y.a,{variant:"primary",onClick:ee,disabled:!X||X>fe},"Esegui")))),s.a.createElement(u.a,null,s.a.createElement(v.a,{bootstrap4:!0,keyField:"id",data:R.rows,columns:Object(w.b)(oe,R.players),cellEdit:Object(w.a)(Object(N.c)(t)),selectRow:se,noDataIndication:s.a.createElement(S,{addRow:function(){return Z()},optionsLength:R.players.length}),caption:s.a.createElement(x,{tournament:R.tournament}),wrapperClasses:"player-table",headerClasses:"default-background default-color-white",striped:!0,hover:!0}))),s.a.createElement(p.a,{style:{margin:"10px"},md:2},s.a.createElement(C.a,{message:I.message,type:I.type})))}))}}}]);
//# sourceMappingURL=9.53cd473d.chunk.js.map