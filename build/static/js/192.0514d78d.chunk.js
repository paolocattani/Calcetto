(this.webpackJsonpcalcetto=this.webpackJsonpcalcetto||[]).push([[192],{1209:function(e,t,a){},1210:function(e,t,a){"use strict";var r=a(8),n=a(2),o=a(11),i=a.n(o),c=a(0),l=a.n(c),s=a(32),u=a(13),p=Object(s.a)("input-group-append"),d=Object(s.a)("input-group-prepend"),m=Object(s.a)("input-group-text",{Component:"span"}),f=l.a.forwardRef((function(e,t){var a=e.bsPrefix,o=e.size,c=e.className,s=e.as,p=void 0===s?"div":s,d=Object(r.a)(e,["bsPrefix","size","className","as"]);return a=Object(u.a)(a,"input-group"),l.a.createElement(p,Object(n.a)({ref:t},d,{className:i()(c,a,o&&a+"-"+o)}))}));f.displayName="InputGroup";var g=Object(n.a)({},f,{Text:m,Radio:function(e){return l.a.createElement(m,null,l.a.createElement("input",Object(n.a)({type:"radio"},e)))},Checkbox:function(e){return l.a.createElement(m,null,l.a.createElement("input",Object(n.a)({type:"checkbox"},e)))},Append:p,Prepend:d});t.a=g},1412:function(e,t,a){"use strict";a.r(t);var r=a(4),n=a(14),o=a(7),i=a.n(o),c=a(22),l=a(287),s=a(0),u=a.n(s),p=a(1210),d=a(323),m=a(104),f=a(178),g=a(139),b=a(382),y=a.n(b),h=a(24),v=a(37),w=a(19),E=a(60),j=a(283),O=function(e){var t=e.addRow,a=e.optionsLength,r=e.isEditable,n=Object(j.a)(["common","pair"]).t,o=a-1,i=o<8?8-o:0;return a?o>=8?u.a.createElement(u.a.Fragment,null,u.a.createElement("p",null,"".concat(n("pair:missing.1"),"...")),u.a.createElement(m.a,{variant:"success",onClick:t,disabled:!r},n("pair:add.one"))):u.a.createElement(u.a.Fragment,null,u.a.createElement("p",null,n("pair:missing.2",{current:o,min:8})),u.a.createElement("p",null,"".concat(1===i?n("pair:missing.3"):n("pair:missing.4",{diff:i}),"...")),u.a.createElement(E.b,{to:"/player"},u.a.createElement(m.a,{variant:"success"},n("common:root.player")))):null},x=a(74),k=a(50),S=a(333),C=a.n(S),T=a(349),N=u.a.forwardRef((function(e,t){var a=e.styles,r=e.row,n=e.columnIndex,o=(e.onUpdate,e.onSelect),i=e.options,c=Object(s.useState)(),p=Object(l.a)(c,2),d=p[0],m=p[1];return u.a.createElement(T.a,{styles:a,options:i,onChange:function(e,t){m(e),o(e,r.id,n)},getOptionLabel:function(e){return e.alias},getOptionValue:function(e){var t;return null===(t=e.id)||void 0===t?void 0:t.toString(10)},value:d,placeholder:"Cerca...",isSearchable:!0,isClearable:!0})})),P=a(96),F=function(e,t,a,r,n,o,i){return u.a.createElement(N,Object.assign({},e,{id:n,row:a,rowIndex:r,columnIndex:n,value:t,onSelect:o,options:i,styles:P.a}))},R={align:function(){return"center"},headerStyle:function(e,t){return{width:"7,5%"}},editor:{type:S.Type.CHECKBOX,value:"".concat("Si",":").concat("No")},style:function(e,t,a,r){return"No"!==e?{backgroundColor:"#ffbf47"}:null}},A=function(e,t,a){return[{dataField:"id",text:"ID",editable:!1,hidden:!0,align:function(){return"center"}},{dataField:"rowNumber",text:"ID",editable:!1,align:function(){return"center"}},{dataField:"player1.alias",text:a.player1,align:function(){return"center"},editorRenderer:function(a,r,n,o,i,c){return F(a,r,n,i,c,e,t)},headerStyle:function(e,t){return{width:"20%"}}},{dataField:"player2.alias",text:a.player1,align:function(){return"center"},editorRenderer:function(a,r,n,o,i,c){return F(a,r,n,i,c,e,t)},headerStyle:function(e,t){return{width:"20%"}}},{dataField:"alias",text:a.alias,headerStyle:function(e,t){return{width:"25%"}}},{dataField:"stage1Name",text:a.stage1,align:function(){return"center"},headerStyle:function(e,t){return{width:"10%"}},editor:{type:S.Type.SELECT,options:"abcdefghijklmnopqrstuvwxyz".toUpperCase().split("").map((function(e){return{value:e,label:e}}))}},Object(r.a)({dataField:"paid1",text:"Pagato 1"},R),Object(r.a)({dataField:"paid2",text:"Pagato 2"},R)]},I=(a(1209),a(313)),z=a.n(I),M=a(61),_=a(68),B=a(137),L=a(12),J=a(334),Z=a(27),D={message:"",onClick:function(){return console.log("")},show:!1,title:""};t.default=Object(h.i)((function(){var e=Object(h.g)(),t=Object(v.c)(),a=Object(j.a)(["common","pair"]).t,o=Object(v.d)(_.a.isAdmin),b=Object(v.d)(B.a.getTournament),E=Object(s.useState)({state:!1,message:a("common:loading")}),S=Object(l.a)(E,2),T=S[0],N=S[1],F=Object(s.useState)(D),R=Object(l.a)(F,2),I=R[0],U=R[1],q=Object(s.useState)({rows:[],players:[]}),$=Object(l.a)(q,2),H=$[0],Y=$[1],G=Object(s.useState)([]),K=Object(l.a)(G,2),V=K[0],X=K[1],Q=Object(s.useState)(0),W=Object(l.a)(Q,2),ee=W[0],te=W[1],ae=Object(s.useState)(0),re=Object(l.a)(ae,2),ne=re[0],oe=re[1];function ie(e){N({state:!1,message:e}),w.b.error(e,{autoClose:1e4})}function ce(e){N({state:!1,message:e}),w.b.success(e)}function le(e){return se.apply(this,arguments)}function se(){return(se=Object(c.a)(i.a.mark((function e(t){var r,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,N({state:!0,message:a("common:loading")}),(r=Object(P.c)()).tId=b.id||0,e.next=6,fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 6:return o=e.sent,e.next=9,o.json();case 9:c=e.sent,r.id=c.id,r.rowNumber=t||H.rows.length+1,Y((function(e){return{rows:[r].concat(Object(n.a)(e.rows)),players:e.players}})),ce(a("pair:success.add")),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),ie(a("pair:error.19"));case 19:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}function ue(){return pe.apply(this,arguments)}function pe(){return(pe=Object(c.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=H.rows.length+1,a=0;case 2:if(!(a<ne)){e.next=9;break}return e.next=5,le(t);case 5:t++;case 6:a++,e.next=2;break;case 9:oe(0);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(){return me.apply(this,arguments)}function me(){return(me=Object(c.a)(i.a.mark((function e(){var t,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,N({state:!0,message:a("common:loading")}),t=[],V.forEach((function(e){e.player1&&e.player1.id&&t.push(e.player1),e.player2&&e.player2.id&&t.push(e.player2)})),t&&Y((function(e){return{rows:e.rows,players:[].concat(t,Object(n.a)(e.players)).sort((function(e,t){return e.alias.localeCompare(t.alias)}))}})),e.next=7,fetch("/api/v1/pair",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)});case 7:return r=e.sent,e.next=10,r.json();case 10:Y((function(e){return{rows:e.rows.filter((function(e){return!V.find((function(t){return t.id===e.id}))})),players:e.players}})),ce(a("pair:success.".concat(V.length>1?"deleteMulti":"deleteOne"))),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),ie(a("pair:error.18"));case 17:X([]);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function fe(e,t){e&&e.id?t.id?Y((function(a){return{rows:a.rows,players:[].concat(Object(n.a)(a.players.filter((function(e){return e.id!==t.id}))),[e]).sort((function(e,t){return e.alias.localeCompare(t.alias)}))}})):Y((function(t){return{rows:t.rows,players:[].concat(Object(n.a)(t.players),[e]).sort((function(e,t){return e.alias.localeCompare(t.alias)}))}})):t.id&&Y((function(e){return{rows:e.rows,players:e.players.filter((function(e){return e.id!==t.id}))}}))}Object(s.useEffect)((function(){b&&Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Y,e.next=3,Object(P.b)(b.id);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))()}),[b]);var ge=function(){var e=Object(c.a)(i.a.mark((function e(t,r,n){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(H.rows.map(function(){var e=Object(c.a)(i.a.mark((function e(o){var c,l,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.id!==r){e.next=15;break}if(c=o,1===n?t.id&&c.player2&&c.player2.id===t.id?(c.player1=Object(M.c)(),ie(a("pair:error.17"))):(fe(c.player1,t),c.player1=t):t.id&&c.player1&&c.player1.id===t.id?(c.player2=Object(M.c)(),ie(a("pair:error.17"))):(fe(c.player2,t),c.player2=t),!(!c.alias&&c.player1&&c.player1.id&&c.player2&&c.player2.id)){e.next=11;break}return e.next=6,fetch("/api/v1/pair/alias?player1Id=".concat(encodeURIComponent(c.player1.id),"&player2Id=").concat(encodeURIComponent(c.player2.id)));case 6:return l=e.sent,e.next=9,l.json();case 9:s=e.sent,l.ok&&s.alias?c.alias=s.alias:c.alias="";case 11:return fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),e.abrupt("return",c);case 15:return e.abrupt("return",o);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:o=e.sent,Y((function(e){return{rows:o,players:e.players}}));case 4:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),be=function(){var r=Object(c.a)(i.a.mark((function r(){var n,c,l,s,u;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(b.id||(ie("".concat(a("pair:error.16"),"...")),setTimeout((function(){return e.push("/")}),5e3)),!(H.rows.length<4)){r.next=4;break}return ie(a("pair:error.15")),r.abrupt("return");case 4:if(0===(n=H.rows.filter((function(e){return!e.stage1Name||""===e.stage1Name})).map((function(e){return e.rowNumber}))).length){r.next=8;break}return ie(a("pair:error.".concat(1===n.length?"13":"14"),{missingStage1Name:n})),r.abrupt("return");case 8:if(0===(c=H.rows.filter((function(e){return!e.player1||!e.player1.id||!e.player2||!e.player2.id})).map((function(e){return e.rowNumber}))).length){r.next=12;break}return ie(a("pair:error.".concat(1===c.length?"11":"12"),{missingPairs:c})),r.abrupt("return");case 12:for(u in 3,l=[],s=H.rows.reduce((function(e,t){return t.stage1Name in e?e[t.stage1Name]++:e[t.stage1Name]=1,e}),{}))s[u]<=3&&l.push(u);if(!(l.length>0)){r.next=19;break}return ie(a("pair:error.".concat(1===l.length?"9":"10"),{invalidStage:l,min:4})),r.abrupt("return");case 19:o&&b.progress<Z.TournamentProgress.Stage1&&(b.progress=Z.TournamentProgress.Stage1,t(L.f.update.request({model:b}))),t(L.a.fetch.request({tId:b.id})),e.push("/stage1");case 22:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();function ye(){e.push("/")}var he={mode:"checkbox",onSelect:function(e,t){return X((function(a){var r=!!a.find((function(t){return t.id===e.id}));return t?r?a:[e].concat(Object(n.a)(a)):r?a.filter((function(t){return t.id!==e.id})):a})),!0},onSelectAll:function(e,t){return X(e?t:[])},style:{backgroundColor:"#c8e6c9"},hideSelectColumn:!o||b.progress>Z.TournamentProgress.PairsSelection},ve=function(){var e=Object(c.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,N({state:!0,message:a("common:loading")}),e.next=4,fetch("/api/v1/stage1",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({tId:b.id})});case 4:return n=e.sent,e.next=7,n.json();case 7:o&&t(L.f.update.request({model:Object(r.a)(Object(r.a)({},b),{},{progress:Z.TournamentProgress.PairsSelection})})),ce(a("pair:success.delete")),U(D),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),ie(a("pair:error.8"));case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();function we(){b.progress>Z.TournamentProgress.Stage1?ie(a("pair:error.7")):U({message:"".concat(a("pair:stage1.resetConfirm")," ?"),onClick:function(){return ve()},onHide:function(){return U(D)},show:!0,title:a("pair:stage1.reset")})}function Ee(){return je.apply(this,arguments)}function je(){return(je=Object(c.a)(i.a.mark((function e(){var t,r,n,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ee){e.next=3;break}return ie(a("pair:error.6")),e.abrupt("return");case 3:if(!(b.progress>Z.TournamentProgress.PairsSelection)){e.next=6;break}return ie(a("pair:error.5")),e.abrupt("return");case 6:for(o in N({state:!0,message:a("common:loading")}),t=0,r="abcdefghijklmnopqrstuvwxyz".toUpperCase().split(""),n=[],H.rows){c=H.rows[o],t==ee&&(t=0),c.stage1Name=r[t],t++;try{fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),n.push(c)}catch(i){ie("Errore"),n.push(c)}}ce(a("pair:success.stage1Name")),Y((function(e){return{rows:n,players:e.players}}));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Oe,xe=Math.floor(Math.floor((H.players.length-1)/2)-(0===H.rows.length?0:H.rows.reduce((function(e,t){var a,r;return!t.player1&&!t.player2||!(null===(a=t.player1)||void 0===a?void 0:a.id)&&!(null===(r=t.player2)||void 0===r?void 0:r.id)?e+1:t.player1&&t.player1.id&&t.player2&&t.player2.id?e:e+.5}),0))),ke=V.length<=0||b.progress>Z.TournamentProgress.PairsSelection,Se={player1:a("pair:field.player1"),player2:a("pair:field.player2"),alias:a("pair:field.alias"),stage1:a("pair:field.stage1"),paid1:a("pair:field.paid1"),paid2:a("pair:field.paid2")};return u.a.createElement("div",null,u.a.createElement(x.YesNoModal,{message:I.message,title:I.title,onClick:I.onClick,show:I.show}),u.a.createElement(x.LoadingModal,{show:T.state,message:T.message}),u.a.createElement(g.a,null,u.a.createElement("div",{className:z.a.toolsBarContainer},u.a.createElement(f.a,{className:z.a.toolsBar},u.a.createElement(g.a,null,u.a.createElement(m.a,{variant:"secondary",className:"float-left align-middle",onClick:ye},u.a.createElement(k.e,null)," ",a("common:route.home"))),b.progress>Z.TournamentProgress.PairsSelection?null:u.a.createElement(g.a,null,u.a.createElement(m.a,{variant:"success",className:"align-middle",onClick:function(){return le()},disabled:xe<=0||!o},u.a.createElement(k.j,null)," ",a("pair:add.one"))),b.progress>Z.TournamentProgress.PairsSelection?null:u.a.createElement(g.a,null,u.a.createElement(m.a,{variant:"danger",className:"align-middle",onClick:de,disabled:ke||!o},u.a.createElement(k.p,null)," ",1===V.length?a("pair:delete.one"):a("pair:delete.multi"))),b.progress!==Z.TournamentProgress.Stage1?null:u.a.createElement(g.a,null,u.a.createElement(m.a,{variant:"danger",className:"align-middle",onClick:we,disabled:!o},a("stage1:reset"))),u.a.createElement(g.a,null,u.a.createElement(m.a,{variant:"outline-warning",className:"default-color-white float-right align-middle",onClick:be,disabled:!o},u.a.createElement("b",null,a("common:continue")," ")," ",u.a.createElement(k.k,null)))),o&&b.progress<Z.TournamentProgress.PairsSelection?u.a.createElement(u.a.Fragment,null,u.a.createElement(p.a,null,u.a.createElement(p.a.Prepend,null,u.a.createElement(p.a.Text,null,a("pair:stage1.set"))),u.a.createElement(d.a,{placeholder:H.rows.length<4?a("pair:error.3"):a("pair:error.4",{max:Math.floor(H.rows.length/4)}),type:"number",step:1,min:0,max:Math.floor(H.rows.length/4),value:0!==ee?ee:void 0,onChange:function(e){return te(Number(e.currentTarget.value))},disabled:H.rows.length<4||b.progress===Z.TournamentProgress.Stage1||b.progress===Z.TournamentProgress.Stage2}),u.a.createElement(p.a.Append,null,u.a.createElement(m.a,{variant:"primary",onClick:Ee,disabled:!ee||ee>Math.floor(H.rows.length/4)||H.rows.length<4},a("common:exec")))),u.a.createElement(p.a,null,u.a.createElement(p.a.Prepend,null,u.a.createElement(p.a.Text,null,a("pair:add.multi"))),u.a.createElement(d.a,{disabled:xe<=0,type:"number",step:1,min:1,max:xe,placeholder:xe<=0?a("pair:error.1"):a("pair:error.2",{max:xe}),onChange:function(e){return oe(Number(e.currentTarget.value))},value:ne||""}),u.a.createElement(p.a.Append,null,u.a.createElement(m.a,{variant:"primary",onClick:function(e){return oe(xe)},disabled:ne>xe},a("common:max")),u.a.createElement(m.a,{variant:"primary",onClick:ue,disabled:!ne||ne>xe},a("common:exec"))))):null),u.a.createElement(f.a,null,u.a.createElement(g.a,null,H.rows&&H.players?u.a.createElement(y.a,{bootstrap4:!0,keyField:"id",data:H.rows,columns:A(ge,H.players,Se),cellEdit:(Oe=o&&b.progress<Z.TournamentProgress.Stage1,C()({mode:Oe?"click":"none",blurToSave:!0,afterSaveCell:function(e,t,a,r){"player1.alias"!==r.dataField&&"player2.alias"!==r.dataField&&Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 2:return t=e.sent,e.next=5,t.json();case 5:case"end":return e.stop()}}),e)})))()}})),selectRow:he,noDataIndication:function(){return u.a.createElement(O,{isEditable:o||!1,addRow:function(){return le()},optionsLength:H.players.length})},caption:u.a.createElement(J.a,null),headerClasses:"default-background default-color-yellow",striped:!0,hover:!0}):null))))}))},295:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return n})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return i}));function r(e){var t=new Date(e),a=""+(t.getMonth()+1),r=""+t.getDate(),n=t.getFullYear();return a.length<2&&(a="0"+a),r.length<2&&(r="0"+r),[n,a,r].join("/")}new RegExp("^d{10}$");var n=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,16})"),o=new RegExp("^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$");function i(e,t){return Math.log(t)/Math.log(e)}},313:function(e,t,a){e.exports={functionsList:"common_functionsList__3B3UB",toolsBarContainer:"common_toolsBarContainer__1nanA",toolsBarRow:"common_toolsBarRow__r8q12"}},334:function(e,t,a){"use strict";var r=a(0),n=a.n(r),o=a(73),i=a(37),c=a(178),l=a(139),s=a(279),u=a(295),p=a(283);t.a=function(){var e=Object(i.d)(o.f.getTournament),t=Object(p.a)(["tournament"]).t;return n.a.createElement(c.a,null,n.a.createElement(l.a,null,n.a.createElement("h2",{className:"float-left"},n.a.createElement(s.a,{variant:"info"},n.a.createElement("span",null,t("tournament:tournament")," "),n.a.createElement("strong",null,'"',e.name.toUpperCase(),'"'),n.a.createElement("span",null,n.a.createElement("i",null," - ".concat(Object(u.b)(e.date)," "),n.a.createElement("small",null," @ ",t("tournament:progress.".concat(e.progress)))))))))}}}]);
//# sourceMappingURL=192.0514d78d.chunk.js.map