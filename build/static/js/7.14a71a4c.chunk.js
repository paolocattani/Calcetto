(this.webpackJsonpcalcetto=this.webpackJsonpcalcetto||[]).push([[7],{273:function(e,t,a){e.exports={functionsList:"common_functionsList__3B3UB",toolsBarContainer:"common_toolsBarContainer__1nanA",toolsBarRow:"common_toolsBarRow__r8q12"}},287:function(e,t,a){"use strict";a.d(t,"b",(function(){return g})),a.d(t,"d",(function(){return h})),a.d(t,"a",(function(){return b})),a.d(t,"e",(function(){return y}));a(8),a(29),a(20);var n,r,i,o,l,c,s=a(133),u=(a(0),a(106),a(299)),p=a.n(u),d=a(274),f=a.n(d),m=(a(58),a(132));function g(){n(""),r(""),i(""),o(""),l(""),c("")}var h=p()(),b=function(e,t){return f()({mode:e?"click":"none",blurToSave:!0,autoSelectText:!0,afterSaveCell:function(e,a,n,r){return t(n)}})};t.c=function(e){var t;return[{dataField:"rowNumber",text:"ID",editable:!1,headerStyle:function(e,t){return{width:"3%"}}},{dataField:"name",text:"Nome",headerClasses:"player-table-header-element",autoSelectText:!0,headerStyle:function(t,a){return{width:e?"16%":"25%"}},filter:Object(u.textFilter)({placeholder:"Filtra...",getFilter:function(e){return n=e}})},{dataField:"surname",text:"Cognome",headerClasses:"player-table-header-element",autoSelectText:!0,headerStyle:function(t,a){return{width:e?"16%":"25%"}},filter:Object(u.textFilter)({placeholder:"Filtra...",getFilter:function(e){return r=e}})},{dataField:"alias",text:"Alias",headerClasses:"player-table-header-element",headerStyle:function(t,a){return{width:e?"17%":"25%"}},autoSelectText:!0,filter:Object(u.textFilter)({placeholder:"Filtra...",getFilter:function(e){return i=e}})},{dataField:"role",text:"Roulo",headerClasses:"player-table-header-element",headerStyle:function(t,a){return{width:"".concat(e?"11":"15","%")}},filter:Object(u.selectFilter)({placeholder:"Filtra...",options:(t={},Object(s.a)(t,m.a.GoalKeeper,m.a.GoalKeeper),Object(s.a)(t,m.a.Striker,m.a.Striker),Object(s.a)(t,m.a.Master,m.a.Master),t),getFilter:function(e){return o=e}}),editor:{type:d.Type.SELECT,getOptions:function(e){return[{value:m.a.GoalKeeper,label:m.a.GoalKeeper},{value:m.a.Striker,label:m.a.Striker},{value:m.a.Master,label:m.a.Master}]}}},{dataField:"email",text:"Email",headerStyle:function(e,t){return{width:"20%"}},headerClasses:"player-table-header-element",autoSelectText:!0,hidden:!e,filter:Object(u.textFilter)({placeholder:"Filtra...",getFilter:function(e){return l=e}})},{dataField:"phone",headerStyle:function(e,t){return{width:"10%"}},text:"Telefono",headerClasses:"player-table-header-element",autoSelectText:!0,hidden:!e,filter:Object(u.textFilter)({placeholder:"Filtra...",getFilter:function(e){return c=e}})},{dataField:"match_played",text:"Partite Giocate",hidden:!0},{dataField:"match_won",text:"Vittorie",hidden:!0},{dataField:"total_score",text:"Punteggio",hidden:!0}]};function y(e){return e?e.alias?e.alias:e.surname?"".concat(e.name," - ").concat(e.surname):e.name:""}},361:function(e,t,a){},362:function(e,t,a){"use strict";var n=a(6),r=a(2),i=a(9),o=a.n(i),l=a(0),c=a.n(l),s=a(28),u=a(12),p=Object(s.a)("input-group-append"),d=Object(s.a)("input-group-prepend"),f=Object(s.a)("input-group-text",{Component:"span"}),m=c.a.forwardRef((function(e,t){var a=e.bsPrefix,i=e.size,l=e.className,s=e.as,p=void 0===s?"div":s,d=Object(n.a)(e,["bsPrefix","size","className","as"]);return a=Object(u.a)(a,"input-group"),c.a.createElement(p,Object(r.a)({ref:t},d,{className:o()(l,a,i&&a+"-"+i)}))}));m.displayName="InputGroup";var g=Object(r.a)({},m,{Text:f,Radio:function(e){return c.a.createElement(f,null,c.a.createElement("input",Object(r.a)({type:"radio"},e)))},Checkbox:function(e){return c.a.createElement(f,null,c.a.createElement("input",Object(r.a)({type:"checkbox"},e)))},Append:p,Prepend:d});t.a=g},371:function(e,t,a){"use strict";a.r(t);var n=a(29),r=a(8),i=a.n(r),o=a(20),l=a(125),c=a(0),s=a.n(c),u=a(362),p=a(275),d=a(106),f=a(131),m=a(167),g=a(282),h=a.n(g),b=a(19),y=a(37),v=a(33),w=a(107),E=a(127),x=function(){var e=Object(y.c)(E.a.getTournament);return e?s.a.createElement("h3",null,s.a.createElement("p",null,s.a.createElement("b",null,'"',s.a.createElement("strong",null,null===e||void 0===e?void 0:e.name.toUpperCase()),'"',s.a.createElement("small",null," @ ",Object(w.e)(e.progress))))):null},j=a(57),O=function(e){var t=e.addRow,a=e.optionsLength,n=e.isEditable,r=a-1,i=r<8?8-r:0;return a?r>=8?s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null," Aggiungi le coppie per questo torneo..."),s.a.createElement(d.a,{variant:"success",onClick:t,disabled:!n},"Aggiungi Coppia")):s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,"Ci sono solo ",r," giocatori definiti ma devono essercene almeno 8 per poter formare un torneo."),s.a.createElement("p",null,1===i?"Devi creare un altro giocatore...":"Devi creare almeno altri ".concat(i)),s.a.createElement(j.b,{to:"/player"},s.a.createElement(d.a,{variant:"success"},"Gestione Giocatori"))):null},S=a(130),C=a(126),k=a(14),N=a(274),F=a.n(N),T=a(281),A=a(287),R=s.a.forwardRef((function(e,t){var a=e.styles,n=e.row,r=e.columnIndex,i=e.onUpdate,o=e.onSelect,u=e.options,p=Object(c.useState)(),d=Object(l.a)(p,2),f=d[0],m=d[1];return s.a.createElement(T.a,{styles:a,options:u,onChange:function(e,t){m(e);var a=Object(A.e)(e);i(a),o(e,n.id,r)},value:f,placeholder:"Cerca...",isSearchable:!0,isClearable:!0})})),I=a(134),P=function(e,t,a,n,r,i,o){return s.a.createElement(R,Object.assign({},e,{id:r,row:a,rowIndex:n,columnIndex:r,value:t,onSelect:i,options:o,styles:I.a}))},z={align:function(){return"center"},headerStyle:function(e,t){return{width:"7,5%"}},editor:{type:N.Type.CHECKBOX,value:"".concat("Si",":").concat("No")},style:function(e,t,a,n){return"No"!==e?{backgroundColor:"#ffbf47"}:null}},G=function(e,t){return[{dataField:"id",text:"ID",editable:!1,hidden:!0,align:function(){return"center"}},{dataField:"rowNumber",text:"ID",editable:!1,align:function(){return"center"}},{dataField:"player1.alias",text:"Giocatore 1",align:function(){return"center"},editorRenderer:function(a,n,r,i,o,l){return P(a,n,r,o,l,e,t)},headerStyle:function(e,t){return{width:"20%"}}},{dataField:"player2.alias",text:"Giocatore 2",align:function(){return"center"},editorRenderer:function(a,n,r,i,o,l){return P(a,n,r,o,l,e,t)},headerStyle:function(e,t){return{width:"20%"}}},{dataField:"alias",text:"Alias Coppia",headerStyle:function(e,t){return{width:"25%"}}},{dataField:"stage1Name",text:"Nome girone",align:function(){return"center"},headerStyle:function(e,t){return{width:"10%"}},editor:{type:N.Type.SELECT,options:"abcdefghijklmnopqrstuvwxyz".toUpperCase().split("").map((function(e){return{value:e,label:e}}))}},Object(k.a)({dataField:"paid1",text:"Pagato 1"},z),Object(k.a)({dataField:"paid2",text:"Pagato 2"},z)]},M=(a(361),a(273)),_=a.n(M),q=a(58),B=a(54),D=a(64),L=a(17),J={message:"",onClick:function(){return console.log("")},show:!1,title:""};t.default=Object(b.i)((function(){var e=Object(b.g)(),t=Object(y.b)(),a=Object(y.c)(B.a.getSession),r=Object(y.c)(E.a.getTournament),g=Object(c.useState)({state:!1,message:"Caricamento"}),w=Object(l.a)(g,2),j=w[0],k=w[1],N=Object(c.useState)(J),T=Object(l.a)(N,2),A=T[0],R=T[1],P=Object(c.useState)({rows:[],players:[]}),z=Object(l.a)(P,2),M=z[0],K=z[1],U=Object(c.useState)([]),H=Object(l.a)(U,2),V=H[0],X=H[1],Y=Object(c.useState)(0),Q=Object(l.a)(Y,2),W=Q[0],Z=Q[1],$=Object(c.useState)(0),ee=Object(l.a)($,2),te=ee[0],ae=ee[1];function ne(e){k({state:!1,message:e}),v.b.error(e,{autoClose:1e4})}function re(e){k({state:!1,message:e}),v.b.success(e)}function ie(e){return oe.apply(this,arguments)}function oe(){return(oe=Object(o.a)(i.a.mark((function e(t){var a,o,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,k({state:!0,message:"Aggiunta riga in corso"}),(a=Object(I.c)()).tId=r.id||0,e.next=6,fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 6:return o=e.sent,e.next=9,o.json();case 9:l=e.sent,a.id=l.id,a.rowNumber=t||M.rows.length+1,K((function(e){return{rows:[a].concat(Object(n.a)(e.rows)),players:e.players}})),re("Riga aggiunta"),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),ne("Errore aggiunta riga");case 19:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}function le(){return ce.apply(this,arguments)}function ce(){return(ce=Object(o.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=M.rows.length+1,a=0;case 2:if(!(a<te)){e.next=9;break}return e.next=5,ie(t);case 5:t++;case 6:a++,e.next=2;break;case 9:ae(0);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(){return ue.apply(this,arguments)}function ue(){return(ue=Object(o.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,k({state:!0,message:V.length>1?"Cancellazione righe in corso":"Cancellazione riga in corso"}),t=[],V.forEach((function(e){e.player1&&e.player1.id&&t.push(e.player1),e.player2&&e.player2.id&&t.push(e.player2)})),t&&K((function(e){return{rows:e.rows,players:[].concat(t,Object(n.a)(e.players)).sort((function(e,t){return e.alias.localeCompare(t.alias)}))}})),e.next=7,fetch("/api/v1/pair",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)});case 7:return a=e.sent,e.next=10,a.json();case 10:K((function(e){return{rows:e.rows.filter((function(e){return!V.find((function(t){return t.id===e.id}))})),players:e.players}})),re(V.length>1?"Righe cancellate":"Riga cancellata"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),ne("Errore cancellazione riga");case 17:X([]);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function pe(e,t){e&&e.id?t.id?K((function(a){return{rows:a.rows,players:[].concat(Object(n.a)(a.players.filter((function(e){return e.id!==t.id}))),[e]).sort((function(e,t){return e.alias.localeCompare(t.alias)}))}})):K((function(t){return{rows:t.rows,players:[].concat(Object(n.a)(t.players),[e]).sort((function(e,t){return e.alias.localeCompare(t.alias)}))}})):t.id&&K((function(e){return{rows:e.rows,players:e.players.filter((function(e){return e.id!==t.id}))}}))}Object(c.useEffect)((function(){r&&Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=K,e.next=3,Object(I.b)(r.id);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))()}),[r]);var de=function(){var n=Object(o.a)(i.a.mark((function n(){var o,l,c,s,u;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r.id||(ne("Id torneo mancante. Verrai inviato alla Home tra 5 secondi...."),setTimeout((function(){return e.push("/")}),5e3)),!(M.rows.length<4)){n.next=4;break}return ne("Numero di coppie insufficente. Devi formare almeno 4 coppie"),n.abrupt("return");case 4:if(0===(o=M.rows.filter((function(e){return!e.stage1Name||""===e.stage1Name})).map((function(e){return e.rowNumber}))).length){n.next=8;break}return ne("Assegna  ".concat(1===o.length?"la riga ":"le righe "," ").concat(o," ad un girone per procedere ")),n.abrupt("return");case 8:if(0===(l=M.rows.filter((function(e){return!e.player1||!e.player1.id||!e.player2||!e.player2.id})).map((function(e){return e.rowNumber}))).length){n.next=12;break}return ne("Assegna  i giocatori ".concat(1===l.length?"alla riga ":"alle righe "," ").concat(l," per procedere ")),n.abrupt("return");case 12:for(u in 3,c=[],s=M.rows.reduce((function(e,t){return t.stage1Name in e?e[t.stage1Name]++:e[t.stage1Name]=1,e}),{}))s[u]<=3&&c.push(u);if(!(c.length>0)){n.next=19;break}return ne(1===c.length?"Il torneo ".concat(c," deve contenere almeno ").concat(4," coppie"):"I torneI ".concat(c," devono contenere almeno ").concat(4," coppie")),n.abrupt("return");case 19:a.isAdmin&&r.progress<D.a.Stage1&&(r.progress=D.a.Stage1,t(L.f.updateTournament.request({model:r}))),t(L.a.getPairs.request({tId:r.id})),e.push("/stage1");case 22:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();function fe(){e.push("/")}var me={mode:"checkbox",onSelect:function(e,t){X((function(a){var r=!!a.find((function(t){return t.id===e.id}));return t?r?a:[e].concat(Object(n.a)(a)):r?a.filter((function(t){return t.id!==e.id})):a}))},onSelectAll:function(e,t){return X(e?t:[])},style:{backgroundColor:"#c8e6c9"}},ge=function(){var e=Object(o.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,k({state:!0,message:"Cancellazione in corso"}),e.next=4,fetch("/api/v1/stage1",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({tId:r.id})});case 4:return n=e.sent,e.next=7,n.json();case 7:a.isAdmin&&r.progress<D.a.Stage1&&(r.progress=D.a.PairsSelection,t(L.f.updateTournament.request({model:r}))),re("Cancellazione completata"),R(J),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),ne("Errore cancellazione Fase 1");case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();function he(){r.progress>D.a.Stage1?ne("Non \xe8 possibile cancellare in quanto il torneo \xe8 gia alla fase 2"):R({message:"Vuoi resettare i gironi ? ",onClick:function(){return ge()},onHide:function(){return R(J)},show:!0,title:"Reset Gironi"})}function be(){return ye.apply(this,arguments)}function ye(){return(ye=Object(o.a)(i.a.mark((function e(){var t,a,n,o,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(W){e.next=3;break}return ne("Specificare il numero di gironi da assegnare"),e.abrupt("return");case 3:if(r.progress!==D.a.Stage1&&r.progress!==D.a.Stage2){e.next=6;break}return ne("Non riassegnare i gironi in quanto le coppie sono gia state confermate per la fase successiva"),e.abrupt("return");case 6:for(o in k({state:!0,message:"Aggiornamento in corso "}),t=0,a="abcdefghijklmnopqrstuvwxyz".toUpperCase().split(""),n=[],M.rows){l=M.rows[o],t==W&&(t=0),l.stage1Name=a[t],t++;try{fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),n.push(l)}catch(i){ne("Errore"),n.push(l)}}re("Gironi assegnati correttamente"),K((function(e){return{rows:n,players:e.players}}));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}console.log("availableRows : ",M.rows);var ve,we=Math.floor(Math.floor((M.players.length-1)/2)-(0===M.rows.length?0:M.rows.reduce((function(e,t){var a,n;return!t.player1&&!t.player2||!(null===(a=t.player1)||void 0===a?void 0:a.id)&&!(null===(n=t.player2)||void 0===n?void 0:n.id)?e+1:t.player1&&t.player1.id&&t.player2&&t.player2.id?e:e+.5}),0))),Ee=!(V.length>0)||"Stage1"===r.progress||"Stage2"===r.progress;return s.a.createElement("div",null,s.a.createElement(S.YesNoModal,{message:A.message,title:A.title,onClick:A.onClick,show:A.show}),s.a.createElement(S.LoadingModal,{show:j.state,message:j.message}),s.a.createElement(f.a,null,s.a.createElement(m.a,null,s.a.createElement(f.a,{className:_.a.toolsBarContainer},s.a.createElement("div",{className:_.a.toolsBar},s.a.createElement(d.a,{variant:"secondary",className:"float-left align-middle",onClick:fe},s.a.createElement(C.d,null)," Home"),s.a.createElement(d.a,{variant:"success",className:"align-middle",onClick:function(){return ie()},disabled:we<=0||!a.isAdmin},s.a.createElement(C.f,null)," Aggiungi Coppia"),s.a.createElement(d.a,{variant:"danger",className:"align-middle",onClick:se,disabled:Ee||!a.isAdmin},s.a.createElement(C.l,null)," Elimina Coppia"),s.a.createElement(d.a,{variant:"danger",className:"align-middle",onClick:he,disabled:!a.isAdmin},"Reset gironi"),s.a.createElement(d.a,{variant:"outline-warning",className:"default-color-white float-right align-middle",onClick:de,disabled:!a.isAdmin},s.a.createElement("b",null,"Prosegui ")," ",s.a.createElement(C.g,null))),a.isAdmin?s.a.createElement(s.a.Fragment,null,s.a.createElement(u.a,null,s.a.createElement(u.a.Prepend,null,s.a.createElement(u.a.Text,null,"Assegna gironi")),s.a.createElement(p.a,{placeholder:M.rows.length<4?"Inserisci almeno 4 coppie":"Numero di gironi ( max ".concat(Math.floor(M.rows.length/4)," )"),"aria-label":"Numero di gironi",type:"number",step:1,min:0,max:Math.floor(M.rows.length/4),value:W,onChange:function(e){return Z(Number(e.currentTarget.value))},disabled:M.rows.length<4||r.progress===D.a.Stage1||r.progress===D.a.Stage2}),s.a.createElement(u.a.Append,null,s.a.createElement(d.a,{variant:"primary",onClick:be,disabled:!W||W>Math.floor(M.rows.length/4)||M.rows.length<4},"Esegui"))),s.a.createElement(u.a,null,s.a.createElement(u.a.Prepend,null,s.a.createElement(u.a.Text,null,"Aggiungi coppie")),s.a.createElement(p.a,{disabled:we<=0,type:"number",step:1,min:1,max:we,placeholder:we<=0?"Numero massimo di coppie gia creato":"Numero di coppie da aggiungere ( max ".concat(we," )"),"aria-label":"Numero di coppie",onChange:function(e){return ae(Number(e.currentTarget.value))},value:te||""}),s.a.createElement(u.a.Append,null,s.a.createElement(d.a,{variant:"primary",onClick:function(e){return ae(we)},disabled:te>we},"Max"),s.a.createElement(d.a,{variant:"primary",onClick:le,disabled:!te||te>we},"Esegui")))):null)),s.a.createElement(m.a,null,s.a.createElement(f.a,null,M.rows&&M.players?s.a.createElement(h.a,{bootstrap4:!0,keyField:"id",data:M.rows,columns:G((function(e,t,a){var n=M.rows.map((function(n){if(n.id===t){var r=n;return 1===a?e.id&&r.player2&&r.player2.id===e.id?(r.player1=Object(q.c)(),ne("Attenzione : Non puoi selezionare lo stesso giocare ! ")):(pe(r.player1,e),r.player1=e):e.id&&r.player1&&r.player1.id===e.id?(r.player2=Object(q.c)(),ne("Attenzione : Non puoi selezionare lo stesso giocare ! ")):(pe(r.player2,e),r.player2=e),fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),r}return n}));K((function(e){return{rows:n,players:e.players}}))}),M.players),cellEdit:(ve=a.isAdmin,F()({mode:ve?"click":"none",blurToSave:!0,afterSaveCell:function(e,t,a,n){"player1.alias"!==n.dataField&&"player2.alias"!==n.dataField&&Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 2:return t=e.sent,e.next=5,t.json();case 5:case"end":return e.stop()}}),e)})))()}})),selectRow:me,noDataIndication:function(){return s.a.createElement(O,{isEditable:a.isAdmin||!1,addRow:function(){return ie()},optionsLength:M.players.length})},caption:s.a.createElement(x,null),headerClasses:"default-background default-color-yellow",striped:!0,hover:!0}):null))))}))}}]);
//# sourceMappingURL=7.14a71a4c.chunk.js.map