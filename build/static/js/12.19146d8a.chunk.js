(this.webpackJsonpcalcetto=this.webpackJsonpcalcetto||[]).push([[12],{257:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={isLoading:function(e){var t=e.tournamentState.isLoading;return t},getTournament:function(e){return e.tournamentState.tournament},getTournamentsList:function(e){return e.tournamentState.tournamentsList}}},262:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var r=n(57),a=n(14),o=n(11),c=n.n(o),u=n(28),i=n(120);function l(){return{id:null,tId:0,rowNumber:0,player1:Object(i.b)(),player2:Object(i.b)(),alias:"",stage1Name:"",paid1:!1,paid2:!1}}var s=function(e,t){Object(u.a)(c.a.mark((function n(){var r,a;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("/api/v1/pair/list/?tId=".concat(t),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:return r=n.sent,n.next=5,r.json();case 5:a=n.sent,e(a);case 7:case"end":return n.stop()}}),n)})))()};var d={option:function(e,t){return Object(a.a)({},e,{backgroundColor:"white",color:"black","&:hover":{backgroundColor:"#64bd9c",color:"white"}})},input:function(e){return Object(a.a)({},e,{backgroundColor:"#64bd9c"})},control:function(e){return Object(a.a)({},e,{height:"3vmin",marginBottom:"auto"})},singleValue:function(e){return Object(a.a)({},e)},valueContainer:function(e){return Object(a.a)({},e,{height:"100%",fontSize:"larger"})}},f=function(){var e=Object(u.a)(c.a.mark((function e(t){var n,a,o,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/pair/list/?tId=".concat(t),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.next=8,fetch(t?"/api/v1/player/list/".concat(t):"/api/v1/player/list",{method:"GET",headers:{"Content-Type":"application/json"}});case 8:return n=e.sent,e.next=11,n.json();case 11:return o=e.sent,u=[].concat(Object(r.a)(o),[Object(i.b)("Nessun Giocatore")]),console.log("rows : ",a),e.abrupt("return",{rows:a,players:u});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},339:function(e,t,n){},349:function(e,t,n){"use strict";n.r(t);var r=n(117),a=n(0),o=n.n(a),c=n(25),u=n(57),i=n(11),l=n.n(i),s=n(28),d=n(263),f=n.n(d),p=n(256),b=n.n(p),m=function(e){var t=e.title,n=e.saved,r={color:n?"#4feb34":void 0};return o.a.createElement("h3",null,o.a.createElement("b",{style:r},"Girone - ",o.a.createElement("strong",null,t)),n?o.a.createElement("small",null," - Salvataggio in corso..."):null)},h=function(e,t){return{id:"col".concat(e),dataField:"col".concat(e),text:e.toString(),headerStyle:function(e,n){return{width:"".concat(75/t,"%")}},headerAlign:function(e,t){return"center"},editable:function(e,t,n,r){return n!==r-2},align:function(e,t,n,r){return"center"},style:function(e,t,n,r){return n===r-2?{backgroundColor:"#343a40"}:3===parseInt(e,10)||2===parseInt(e,10)?{backgroundColor:"rgb(196, 247, 160)"}:1===parseInt(e,10)||0===parseInt(e,10)?{backgroundColor:"rgb(255, 147, 147)"}:null},editor:{type:p.Type.SELECT,options:[{value:"3",label:"3"},{value:"2",label:"2"},{value:"1",label:"1"},{value:"0",label:"0"},{value:null,label:""}]}}};var g=function(e){for(var t=[{id:"pairLabel",dataField:"pair.label",text:"Nome Coppia",editable:!1,headerStyle:function(e,t){return{width:"15%"}},align:function(e,t,n,r){return"center"},headerAlign:function(e,t){return"center"}},{id:"rowNumber",dataField:"rowNumber",text:"ID",editable:!1,type:"number",headerStyle:function(e,t){return{width:"5%"}},headerAlign:function(e,t){return"center"},style:function(e,t,n,r){return{backgroundColor:"#343a40",color:"#ffc107"}}}],n=0;n<e.length;n++)t.push(h(n+1,e.length));return t.push({id:"totale",dataField:"total",text:"Totale",editable:!1,type:"number",headerStyle:function(e,t){return{width:"5%"}},headerAlign:function(e,t){return"center"}},{id:"place",dataField:"place",text:"Posizione",editable:!0,type:"number",headerStyle:function(e,t){return{width:"5%"}},headerAlign:function(e,t){return"center"}}),t};function v(e,t){return e.total===t.total?3===e["col".concat(t.rowNumber)]||2===e["col".concat(t.rowNumber)]?-1:1:t.total-e.total}var j=n(29),w=n(58),y=(n(339),function(e){var t,n=e.rows,c=e.columns,i=e.tableName,l=e.updateCellValue,s=e.saved,d=Object(a.useState)([]),p=Object(r.a)(d,2),h=p[0],g=p[1],y=Object(j.d)(w.a.getSession),O=function(e,t){return console.log("handleOnSelect : ",e),g((function(){var n=!!h.find((function(t){return t.rowNumber===e.rowNumber}));return t?n?h:[e].concat(Object(u.a)(h)):n?h.filter((function(t){return t.rowNumber!==e.rowNumber})):h})),!0},N={mode:"checkbox",onSelect:O,onSelectAll:function(e,t){return t.forEach((function(t){return O(t,e)}))},style:{backgroundColor:"#c8e6c9"}};return o.a.createElement(f.a,{bootstrap4:!0,keyField:"id",data:n,columns:c,selectRow:N,cellEdit:(t=y.isAdmin,b()({mode:t?"click":"none",blurToSave:!0,beforeSaveCell:function(e,t,r,a){a.id.startsWith("col")&&(n[parseInt(a.text)-1]["col".concat(r.rowNumber)]=function(e){if(null===e)return null;switch(parseInt(e)){case 3:return 0;case 2:return 1;case 1:return 2;case 0:return 3;default:return null}}(t))},afterSaveCell:function(e,t,r,a){if(a.id.startsWith("col")){l(e,t,r,a);var o=0;for(var c in r)c.startsWith("col")&&r[c]&&(o+=parseInt(r[c]));for(var i in n[r.rowNumber-1].total=o||null,o=0,n[parseInt(a.text)-1])i.startsWith("col")&&n[parseInt(a.text)-1][i]&&(o+=parseInt(n[parseInt(a.text)-1][i]));n[parseInt(a.text)-1].total=o||null}Object(u.a)(n).sort((function(e,t){return v(e,t)})).forEach((function(e,t){return n[e.rowNumber-1].place=t+1}))}})),noDataIndication:"Nessun dato reperito",wrapperClasses:"player-table",headerClasses:"default-background default-color-yellow",caption:o.a.createElement(m,{title:i,saved:s}),striped:!0,hover:!0})}),O=function(e){var t,n,c=e.pairsList,i=Object(a.useState)(!1),d=Object(r.a)(i,2),f=d[0],p=d[1],b=Object(a.useState)(!1),m=Object(r.a)(b,2),h=m[0],j=m[1],w=Object(a.useState)(function(e){for(var t=[],n=0;n<e.length;n++){t.push({pair:e[n],rowNumber:n+1});for(var r=1;r<=e.length;r++)t[n]["col".concat(r)]=null;t[n].total=0,t[n].place=0,t[n].id="row-".concat(e[0].tId,"-").concat(n)}return t}(c)),O=Object(r.a)(w,2),N=O[0],E=O[1],S=null!==(t=null===(n=c[0])||void 0===n?void 0:n.stage1Name)&&void 0!==t?t:"Not found",k=function(){var e=Object(s.a)(l.a.mark((function e(t,n,r,a){var o,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={tId:r.pair.tId,tableName:S,score:n,pair1Id:r.pair.id,pair2Id:N[parseInt(a.text)-1].pair.id},e.next=3,fetch("/api/v1/stage1/cell",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 3:return c=e.sent,e.next=6,c.json();case 6:c.ok&&(j(!0),setTimeout((function(){return j(!1)}),3e3));case 7:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){(function(){var e=Object(s.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.next=3,fetch("/api/v1/stage1",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rows:N,stageName:S})});case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,Object(u.a)(n).sort((function(e,t){return v(e,t)})).forEach((function(e,t){return n[e.rowNumber-1].place=t+1})),E(n),p(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),o.a.createElement(o.a.Fragment,null,f?o.a.createElement("h3",null,"Caricamento girone ",o.a.createElement("b",null,S)," in corso...."):o.a.createElement(y,{rows:N,columns:g(c),tableName:S,updateCellValue:k,saved:h}))},N=n(354),E=n(143),S=n(262),k=n(257);t.default=Object(c.i)((function(){var e=Object(j.d)(k.a.getTournament),t=Object(a.useState)([]),n=Object(r.a)(t,2),u=n[0],i=n[1],l=Object(c.g)();Object(a.useEffect)((function(){return Object(S.c)(i,e.id)}),[e.id]);var s=function(e){var t="",n=[],r=[];e.sort((function(e,t){return e.stage1Name.localeCompare(t.stage1Name)})).forEach((function(e,a){""===t&&(t=e.stage1Name),t!==e.stage1Name&&(r.push(o.a.createElement(N.a.Item,{className:"inherit-background",key:"stage-".concat(t)},o.a.createElement(O,{pairsList:n}))),t=e.stage1Name,n=[]),n.push(e)})),n.length>0&&r.push(o.a.createElement(N.a.Item,{className:"inherit-background",key:"stage-".concat(t)},o.a.createElement(O,{pairsList:n})));return o.a.createElement(N.a,{variant:"flush"},r)}(u);return o.a.createElement(o.a.Fragment,null,o.a.createElement(N.a.Item,{className:"inherit-background",key:"stage-button"},o.a.createElement(E.a,{variant:"secondary",onClick:function(){l.push("/tournament")}},"Gestione Coppie")),s)}))}}]);
//# sourceMappingURL=12.19146d8a.chunk.js.map