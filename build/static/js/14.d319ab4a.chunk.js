(this.webpackJsonpcalcetto=this.webpackJsonpcalcetto||[]).push([[14],{1269:function(e,t,a){"use strict";var n=a(2),r=a(8),o=a(11),c=a.n(o),l=a(0),s=a.n(l),u=a(100),i=function(){},d=s.a.forwardRef((function(e,t){var a=e.children,o=e.name,d=e.className,m=e.checked,b=e.type,f=e.onChange,p=e.value,g=e.disabled,h=e.inputRef,O=Object(r.a)(e,["children","name","className","checked","type","onChange","value","disabled","inputRef"]),j=Object(l.useState)(!1),v=j[0],E=j[1],N=Object(l.useCallback)((function(e){"INPUT"===e.target.tagName&&E(!0)}),[]),S=Object(l.useCallback)((function(e){"INPUT"===e.target.tagName&&E(!1)}),[]);return s.a.createElement(u.a,Object(n.a)({},O,{ref:t,className:c()(d,v&&"focus",g&&"disabled"),type:void 0,active:!!m,as:"label"}),s.a.createElement("input",{name:o,type:b,value:p,ref:h,autoComplete:"off",checked:!!m,disabled:!!g,onFocus:N,onBlur:S,onChange:f||i}),a)}));d.displayName="ToggleButton",t.a=d},1283:function(e,t,a){"use strict";a.r(t);var n=a(14),r=a(7),o=a(23),c=a(0),l=a.n(c),s=a(37),u=a(319),i=a.n(u),d=a(51),m=a(180),b=a(142),f=a(100),p=a(280),g=a(1269),h=a(12),O=a(73),j=a(3),v=a.n(j),E=a(20),N=a(290),S=a(391),y=a.n(S),w=a(340),k=a.n(w),C=function(e){var t=e.title,a=e.saved,n={color:a?"#4feb34":void 0};return l.a.createElement("h3",null,l.a.createElement("b",{style:n},"Girone - ",l.a.createElement("strong",null,t)),a?l.a.createElement("small",null," - Salvataggio in corso..."):null)},T=a(151),I={headerAlign:"center"},x={align:"center"},P=function(e,t){return Object(r.a)(Object(r.a)(Object(r.a)({id:"col".concat(e),dataField:"col".concat(e),text:e.toString(),headerStyle:function(e,a){return{width:"".concat(75/t,"%")}}},I),{},{editable:function(e,t,a,n){return a!==n-2}},x),{},{style:function(e,t,a,n){return a===n-2?{backgroundColor:"#343a40"}:3===parseInt(e,10)||2===parseInt(e,10)?{backgroundColor:"rgb(196, 247, 160)"}:1===parseInt(e,10)||0===parseInt(e,10)?{backgroundColor:"rgb(255, 147, 147)"}:null},editor:{type:w.Type.SELECT,options:[{value:"3",label:"3"},{value:"2",label:"2"},{value:"1",label:"1"},{value:"0",label:"0"},{value:null,label:""}]}})},B=function(e){for(var t=[Object(r.a)(Object(r.a)({id:"pairLabel",dataField:"pair.label",text:"Nome Coppia",editable:!1,headerStyle:function(e,t){return{width:"15%"}}},x),I),Object(r.a)(Object(r.a)({id:"rowNumber",dataField:"rowNumber",text:"ID",editable:!1,type:"number",headerStyle:function(e,t){return{width:"5%"}}},I),{},{style:function(e,t,a,n){return{backgroundColor:"#343a40",color:"#ffc107"}}})],a=0;a<e.length;a++)t.push(P(a+1,e.length));return t.push(Object(r.a)({id:"totale",dataField:"total",text:"Totale",editable:!1,type:"number",headerStyle:function(e,t){return{width:"5%"}}},I),Object(r.a)({id:"placement",dataField:"placement",text:"Posizione",editable:!0,type:"number",headerStyle:function(e,t){return{width:"5%"}}},I)),t},R=a(69),A=a(26),F=function(e){var t=e.pairsList,a=e.autoOrder,r=Object(s.c)(),o=Object(s.d)(R.a.isAdmin),u=Object(s.d)(O.f.getTournament),i=Object(c.useState)([]),d=Object(N.a)(i,2),m=d[0],b=d[1],f=Object(c.useState)(!1),p=Object(N.a)(f,2),g=p[0],j=p[1],S=Object(c.useState)(!1),w=Object(N.a)(S,2),I=w[0],x=w[1],P=Object(c.useState)(Object(T.c)(t)),F=Object(N.a)(P,2),_=F[0],q=F[1],L=t[0].stage1Name;Object(c.useEffect)((function(){(function(){var e=Object(E.a)(v.a.mark((function e(){var t,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.next=3,fetch("/api/v1/stage1",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rows:_,stageName:L})});case 3:return t=e.sent,e.next=6,t.json();case 6:r=e.sent,a&&Object(n.a)(r).sort((function(e,t){return Object(T.a)(e,t)})).forEach((function(e,t){return r[e.rowNumber-1].placement=t+1})),q(r),j(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var J,U={mode:"checkbox",onSelect:function(e,t){var a,o=!!m.find((function(t){return t.rowNumber===e.rowNumber}));return a=t?o?m:[e].concat(Object(n.a)(m)):o?m.filter((function(t){return t.rowNumber!==e.rowNumber})):m,console.log("handleOnSelect : "),b(a),r(h.d.updateSelectedPairs.request({stageName:L,rows:a})),!0},onSelectAll:function(e,t){b(e?t:[]),r(h.d.updateSelectedPairs.request({stageName:L,rows:e?t:[]}))},style:{backgroundColor:"#c8e6c9"},hideSelectColumn:!o||u.progress>=A.TournamentProgress.Stage2};return g?l.a.createElement("h3",null,"Caricamento girone ",l.a.createElement("b",null,L)," in corso...."):l.a.createElement(y.a,{key:"Stege1-".concat(L),bootstrap4:!0,keyField:"id",data:_,columns:B(t),selectRow:U,cellEdit:(J=o&&u.progress<A.TournamentProgress.Stage2,k()({mode:J?"click":"none",blurToSave:!0,beforeSaveCell:function(e,t,a,n){n.id.startsWith("col")&&(_[parseInt(n.text)-1]["col".concat(a.rowNumber)]=Object(T.b)(t))},afterSaveCell:function(){var e=Object(E.a)(v.a.mark((function e(t,o,c,l){var s,u,i,d,m,b,f,p,g;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=Object(n.a)(_),!l.id.startsWith("col")){e.next=20;break}return e.next=4,fetch("/api/v1/stage1/cell",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tId:c.pair.tId,tableName:L,score:o,pair1Id:c.pair.id,pair2Id:_[parseInt(l.text)-1].pair.id})});case 4:return u=e.sent,e.next=7,u.json();case 7:for(d in u.ok&&(x(!0),setTimeout((function(){return x(!1)}),3e3)),i=0,c)d.startsWith("col")&&c[d]&&(i+=parseInt(c[d]));for(p in m=c.rowNumber-1,(b=s[m]).total=i||0,i=0,f=parseInt(l.text)-1,s[f])p.startsWith("col")&&s[f][p]&&(i+=parseInt(s[f][p]));(g=s[f]).total=i||0,s.splice(m,1,b),s.splice(f,1,g);case 20:a&&Object(n.a)(s).sort((function(e,t){return Object(T.a)(e,t)})).forEach((function(e,t){return s[e.rowNumber-1].placement=t+1})),q(s),r(h.d.updatePlacement.request({rows:_.map((function(e){return{id:e.pair.id,placement:e.placement}}))}));case 23:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}()})),noDataIndication:"Nessun dato reperito",headerClasses:"default-background default-color-yellow",caption:l.a.createElement(C,{title:L,saved:I}),striped:!0,hover:!0})},_=a(341);t.default=Object(o.i)((function(){var e=Object(o.g)(),t=Object(s.c)(),a=Object(s.d)(O.c.getSession),c=Object(s.d)(O.f.getTournament),u=Object(s.d)(O.d.getNeedRefresh),j=Object(s.d)(O.d.getSelectedPairs),v=Object(s.d)(O.a.getPairsList);console.log("Refreshing : ",u);var E=l.a.createElement("div",{className:i.a.toolsBarContainer},l.a.createElement(m.a,{className:i.a.toolsBarRow},l.a.createElement(b.a,null,l.a.createElement(f.a,{variant:"secondary",onClick:function(){e.push(a.isAdmin?"/tournament":"/")},className:"float-left"},l.a.createElement(d.g,null)," Indietro")),c.progress>A.TournamentProgress.Stage1?l.a.createElement(b.a,null,l.a.createElement(f.a,{variant:"danger",onClick:function(){return t(h.e.delete.request({tId:c.id}))},disabled:!a.isAdmin||a.isAdmin&&c.progress<A.TournamentProgress.Stage2},l.a.createElement(d.p,null)," Reset Fase 2")):null,l.a.createElement(b.a,null,l.a.createElement(f.a,{variant:"outline-warning",className:"default-color-white float-right",onClick:function(){a.isAdmin&&c.progress<A.TournamentProgress.Stage2&&(c.progress=A.TournamentProgress.Stage2,t(h.f.update.request({tournament:c})));var n=8;if(j&&j.length>=4)for(n=j.length-1;n%8!==0;)n++;t(h.e.fetchStage2.request({tournamentId:c.id,count:n})),e.push("/stage2")},disabled:j.length<4&&c.progress<A.TournamentProgress.Stage2},l.a.createElement("b",null,"Prosegui ")," ",l.a.createElement(d.k,null)))),l.a.createElement(m.a,null,l.a.createElement(b.a,null,l.a.createElement(p.a,{toggle:!0,className:"mb-2"},l.a.createElement(g.a,{type:"checkbox",variant:c.autoOrder?"success":"danger",checked:c.autoOrder,value:"1",onChange:function(e){return t(h.f.update.request({tournament:Object(r.a)(Object(r.a)({},c),{},{autoOrder:e.currentTarget.checked})}))}},"Ordinamento automatico : ".concat(c.autoOrder?"Attivato ":" Disattivato"))))));return l.a.createElement(l.a.Fragment,null,E,l.a.createElement(_.a,null),v?function(e,t){var a="",r=[],o=[];Object(n.a)(e).sort((function(e,t){return e.stage1Name.localeCompare(t.stage1Name)})).forEach((function(e,n){""===a&&(a=e.stage1Name),a!==e.stage1Name&&(o.push(l.a.createElement(F,{key:"Stage1-".concat(a),pairsList:r,autoOrder:t})),a=e.stage1Name,r=[]),r.push(e)})),r.length>0&&o.push(l.a.createElement(F,{key:"Stage1-".concat(a),pairsList:r,autoOrder:t}));return o}(v,c.autoOrder):null)}))},319:function(e,t,a){e.exports={functionsList:"common_functionsList__3B3UB",toolsBarContainer:"common_toolsBarContainer__1nanA",toolsBarRow:"common_toolsBarRow__r8q12"}},341:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(73),c=a(37),l=a(180),s=a(142),u=a(281),i=a(138),d=a(285);t.a=function(){var e=Object(c.d)(o.f.getTournament),t=Object(d.a)(["tournament"]).t;return r.a.createElement(l.a,null,r.a.createElement(s.a,null,r.a.createElement("h2",{className:"float-left"},r.a.createElement(u.a,{variant:"info"},r.a.createElement("span",null,t("tournament:tournament")," "),r.a.createElement("strong",null,'"',e.name.toUpperCase(),'"'),r.a.createElement("span",null,r.a.createElement("i",null," - ".concat(Object(i.a)(e.date)," "),r.a.createElement("small",null," @ ",t("tournament:progress.".concat(e.progress)))))))))}}}]);
//# sourceMappingURL=14.d319ab4a.chunk.js.map