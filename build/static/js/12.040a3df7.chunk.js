(this.webpackJsonpcalcetto=this.webpackJsonpcalcetto||[]).push([[12],{270:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"d",(function(){return c})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return u}));var n=a(127);function r(e){switch(e){case n.a.New:return"Nuovo";case n.a.PairsSelection:return"Selezione Coppie";case n.a.Stage1:return"Fase 1";case n.a.Stage2:return"Fase 2";default:return""}}function o(e){var t=new Date(e),a=""+(t.getMonth()+1),n=""+t.getDate(),r=t.getFullYear();return a.length<2&&(a="0"+a),n.length<2&&(n="0"+n),[r,a,n].join("/")}new RegExp("^d{10}$");var c=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,16})"),l=new RegExp("^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$");function u(e,t){return Math.log(t)/Math.log(e)}},273:function(e,t,a){e.exports={functionsList:"common_functionsList__3B3UB",toolsBarContainer:"common_toolsBarContainer__1nanA",toolsBarRow:"common_toolsBarRow__r8q12"}},279:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(128),c=a(37),l=a(166),u=a(131),s=a(2),i=a(7),d=a(11),m=a.n(d),f=a(15),b=r.a.forwardRef((function(e,t){var a=e.bsPrefix,n=e.variant,o=e.pill,c=e.className,l=e.as,u=void 0===l?"span":l,d=Object(i.a)(e,["bsPrefix","variant","pill","className","as"]),b=Object(f.a)(a,"badge");return r.a.createElement(u,Object(s.a)({ref:t},d,{className:m()(c,b,o&&b+"-pill",n&&b+"-"+n)}))}));b.displayName="Badge",b.defaultProps={pill:!1};var p=b,g=a(270);t.a=function(){var e=Object(c.c)(o.f.getTournament);return r.a.createElement(l.a,null,r.a.createElement(u.a,null,r.a.createElement("h2",{className:"float-left"},r.a.createElement(p,{variant:"info"},r.a.createElement("span",null,"Torneo "),r.a.createElement("strong",null,'"',e.name.toUpperCase(),'"'),r.a.createElement("span",null,r.a.createElement("i",null," - ".concat(Object(g.b)(e.date)," "),r.a.createElement("small",null," @ ",Object(g.e)(e.progress))))))))}},371:function(e,t,a){"use strict";a.r(t);var n=a(10),r=a(21),o=a(0),c=a.n(o),l=a(37),u=a(87),s=a(273),i=a.n(s),d=a(126),m=a(166),f=a(131),b=a(96),p=a(262),g=a(2),h=a(7),O=a(11),v=a.n(O),j=function(){},E=c.a.forwardRef((function(e,t){var a=e.children,n=e.name,r=e.className,l=e.checked,u=e.type,s=e.onChange,i=e.value,d=e.disabled,m=e.inputRef,f=Object(h.a)(e,["children","name","className","checked","type","onChange","value","disabled","inputRef"]),p=Object(o.useState)(!1),O=p[0],E=p[1],N=Object(o.useCallback)((function(e){"INPUT"===e.target.tagName&&E(!0)}),[]),S=Object(o.useCallback)((function(e){"INPUT"===e.target.tagName&&E(!1)}),[]);return c.a.createElement(b.a,Object(g.a)({},f,{ref:t,className:v()(r,O&&"focus",d&&"disabled"),type:void 0,active:!!l,as:"label"}),c.a.createElement("input",{name:n,type:u,value:i,ref:m,autoComplete:"off",checked:!!l,disabled:!!d,onFocus:N,onBlur:S,onChange:s||j}),a)}));E.displayName="ToggleButton";var N=E,S=a(12),w=a(128),y=a(5),C=a.n(y),k=a(13),T=a(20),x=a(125),P=a(283),I=a.n(P),A=a(278),R=a.n(A),F=function(e){var t=e.title,a=e.saved,n={color:a?"#4feb34":void 0};return c.a.createElement("h3",null,c.a.createElement("b",{style:n},"Girone - ",c.a.createElement("strong",null,t)),a?c.a.createElement("small",null," - Salvataggio in corso..."):null)},B=a(143),z={headerAlign:"center"},_={align:"center"},q=function(e,t){return Object(n.a)(Object(n.a)(Object(n.a)({id:"col".concat(e),dataField:"col".concat(e),text:e.toString(),headerStyle:function(e,a){return{width:"".concat(75/t,"%")}}},z),{},{editable:function(e,t,a,n){return a!==n-2}},_),{},{style:function(e,t,a,n){return a===n-2?{backgroundColor:"#343a40"}:3===parseInt(e,10)||2===parseInt(e,10)?{backgroundColor:"rgb(196, 247, 160)"}:1===parseInt(e,10)||0===parseInt(e,10)?{backgroundColor:"rgb(255, 147, 147)"}:null},editor:{type:A.Type.SELECT,options:[{value:"3",label:"3"},{value:"2",label:"2"},{value:"1",label:"1"},{value:"0",label:"0"},{value:null,label:""}]}})},L=function(e){for(var t=[Object(n.a)(Object(n.a)({id:"pairLabel",dataField:"pair.label",text:"Nome Coppia",editable:!1,headerStyle:function(e,t){return{width:"15%"}}},_),z),Object(n.a)(Object(n.a)({id:"rowNumber",dataField:"rowNumber",text:"ID",editable:!1,type:"number",headerStyle:function(e,t){return{width:"5%"}}},z),{},{style:function(e,t,a,n){return{backgroundColor:"#343a40",color:"#ffc107"}}})],a=0;a<e.length;a++)t.push(q(a+1,e.length));return t.push(Object(n.a)({id:"totale",dataField:"total",text:"Totale",editable:!1,type:"number",headerStyle:function(e,t){return{width:"5%"}}},z),Object(n.a)({id:"placement",dataField:"placement",text:"Posizione",editable:!0,type:"number",headerStyle:function(e,t){return{width:"5%"}}},z)),t},Z=a(55),D=function(e){var t=e.pairsList,a=e.autoOrder,n=Object(l.b)(),r=Object(l.c)(Z.a.isAdmin),s=Object(l.c)(w.f.getTournament),i=Object(o.useState)([]),d=Object(x.a)(i,2),m=d[0],f=d[1],b=Object(o.useState)(!1),p=Object(x.a)(b,2),g=p[0],h=p[1],O=Object(o.useState)(!1),v=Object(x.a)(O,2),j=v[0],E=v[1],N=Object(o.useState)(Object(B.c)(t)),y=Object(x.a)(N,2),P=y[0],A=y[1],z=t[0].stage1Name;Object(o.useEffect)((function(){(function(){var e=Object(T.a)(C.a.mark((function e(){var t,n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,fetch("/api/v1/stage1",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rows:P,stageName:z})});case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,a&&Object(k.a)(n).sort((function(e,t){return Object(B.a)(e,t)})).forEach((function(e,t){return n[e.rowNumber-1].placement=t+1})),A(n),h(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var _,q={mode:"checkbox",onSelect:function(e,t){var a,r=!!m.find((function(t){return t.rowNumber===e.rowNumber}));return a=t?r?m:[e].concat(Object(k.a)(m)):r?m.filter((function(t){return t.rowNumber!==e.rowNumber})):m,console.log("handleOnSelect : "),f(a),n(S.e.updateSelectedPairs.request({stageName:z,rows:a})),!0},onSelectAll:function(e,t){f(e?t:[]),n(S.e.updateSelectedPairs.request({stageName:z,rows:e?t:[]}))},style:{backgroundColor:"#c8e6c9"},hideSelectColumn:!r||s.progress>=u.TournamentProgress.Stage2};return g?c.a.createElement("h3",null,"Caricamento girone ",c.a.createElement("b",null,z)," in corso...."):c.a.createElement(I.a,{key:"Stege1-".concat(z),bootstrap4:!0,keyField:"id",data:P,columns:L(t),selectRow:q,cellEdit:(_=r&&s.progress<u.TournamentProgress.Stage2,R()({mode:_?"click":"none",blurToSave:!0,beforeSaveCell:function(e,t,a,n){n.id.startsWith("col")&&(P[parseInt(n.text)-1]["col".concat(a.rowNumber)]=Object(B.b)(t))},afterSaveCell:function(){var e=Object(T.a)(C.a.mark((function e(t,r,o,c){var l,u,s,i,d,m,f,b,p;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=Object(k.a)(P),!c.id.startsWith("col")){e.next=20;break}return e.next=4,fetch("/api/v1/stage1/cell",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tId:o.pair.tId,tableName:z,score:r,pair1Id:o.pair.id,pair2Id:P[parseInt(c.text)-1].pair.id})});case 4:return u=e.sent,e.next=7,u.json();case 7:for(i in u.ok&&(E(!0),setTimeout((function(){return E(!1)}),3e3)),s=0,o)i.startsWith("col")&&o[i]&&(s+=parseInt(o[i]));for(b in d=o.rowNumber-1,(m=l[d]).total=s||0,s=0,f=parseInt(c.text)-1,l[f])b.startsWith("col")&&l[f][b]&&(s+=parseInt(l[f][b]));(p=l[f]).total=s||0,l.splice(d,1,m),l.splice(f,1,p);case 20:a&&Object(k.a)(l).sort((function(e,t){return Object(B.a)(e,t)})).forEach((function(e,t){return l[e.rowNumber-1].placement=t+1})),A(l),n(S.e.updatePlacement.request({rows:P.map((function(e){return{id:e.pair.id,placement:e.placement}}))}));case 23:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}()})),noDataIndication:"Nessun dato reperito",headerClasses:"default-background default-color-yellow",caption:c.a.createElement(F,{title:z,saved:j}),striped:!0,hover:!0})},J=a(279);t.default=Object(r.i)((function(){var e=Object(r.g)(),t=Object(l.b)(),a=Object(l.c)(w.c.getSession),o=Object(l.c)(w.f.getTournament,(function(e,t){return(null===e||void 0===e?void 0:e.progress)!==(null===t||void 0===t?void 0:t.progress)})),s=Object(l.c)(w.d.getNeedRefresh),g=Object(l.c)(w.d.getSelectedPairs),h=Object(l.c)(w.a.getPairsList);console.log("Refreshing : ",s);var O=c.a.createElement("div",{className:i.a.toolsBarContainer},c.a.createElement(m.a,{className:i.a.toolsBarRow},c.a.createElement(f.a,null,c.a.createElement(b.a,{variant:"secondary",onClick:function(){e.push(a.isAdmin?"/tournament":"/")},className:"float-left"},c.a.createElement(d.e,null)," Indietro")),o.progress>u.TournamentProgress.Stage1?c.a.createElement(f.a,null,c.a.createElement(b.a,{variant:"danger",onClick:function(){return t(S.f.delete.request({tId:o.id}))},disabled:!a.isAdmin||a.isAdmin&&o.progress<u.TournamentProgress.Stage2},c.a.createElement(d.l,null)," Reset Fase 2")):null,c.a.createElement(f.a,null,c.a.createElement(b.a,{variant:"outline-warning",className:"default-color-white float-right",onClick:function(){a.isAdmin&&o.progress<u.TournamentProgress.Stage2&&(o.progress=u.TournamentProgress.Stage2,t(S.g.updateTournament.request({model:o})));var n=8;if(g&&g.length>=4)for(n=g.length-1;n%8!==0;)n++;t(S.f.fetchStage2.request({tournamentId:o.id,count:n})),e.push("/stage2")},disabled:g.length<4&&o.progress<u.TournamentProgress.Stage2},c.a.createElement("b",null,"Prosegui ")," ",c.a.createElement(d.g,null)))),c.a.createElement(m.a,null,c.a.createElement(f.a,null,c.a.createElement(p.a,{toggle:!0,className:"mb-2"},c.a.createElement(N,{type:"checkbox",variant:o.autoOrder?"success":"danger",checked:o.autoOrder,value:"1",onChange:function(e){return t(S.g.updateTournament.request({model:Object(n.a)(Object(n.a)({},o),{},{autoOrder:e.currentTarget.checked})}))}},"Ordinamento automatico : ".concat(o.autoOrder?"Attivato ":" Disattivato"))))));return c.a.createElement(c.a.Fragment,null,O,c.a.createElement(J.a,null),h?function(e,t){var a="",n=[],r=[];e.sort((function(e,t){return e.stage1Name.localeCompare(t.stage1Name)})).forEach((function(e,o){""===a&&(a=e.stage1Name),a!==e.stage1Name&&(r.push(c.a.createElement(D,{key:"Stage1-".concat(a),pairsList:n,autoOrder:t})),a=e.stage1Name,n=[]),n.push(e)})),n.length>0&&r.push(c.a.createElement(D,{key:"Stage1-".concat(a),pairsList:n,autoOrder:t}));return r}(h,o.autoOrder):null)}))}}]);
//# sourceMappingURL=12.040a3df7.chunk.js.map