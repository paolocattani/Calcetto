(this.webpackJsonpcalcetto=this.webpackJsonpcalcetto||[]).push([[6],{270:function(e,a,t){"use strict";t.d(a,"e",(function(){return r})),t.d(a,"b",(function(){return o})),t.d(a,"d",(function(){return i})),t.d(a,"a",(function(){return c})),t.d(a,"c",(function(){return l}));var n=t(127);function r(e){switch(e){case n.a.New:return"Nuovo";case n.a.PairsSelection:return"Selezione Coppie";case n.a.Stage1:return"Fase 1";case n.a.Stage2:return"Fase 2";default:return""}}function o(e){var a=new Date(e),t=""+(a.getMonth()+1),n=""+a.getDate(),r=a.getFullYear();return t.length<2&&(t="0"+t),n.length<2&&(n="0"+n),[r,t,n].join("/")}new RegExp("^d{10}$");var i=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,16})"),c=new RegExp("^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$");function l(e,a){return Math.log(a)/Math.log(e)}},273:function(e,a,t){e.exports={functionsList:"common_functionsList__3B3UB",toolsBarContainer:"common_toolsBarContainer__1nanA",toolsBarRow:"common_toolsBarRow__r8q12"}},279:function(e,a,t){"use strict";var n=t(0),r=t.n(n),o=t(128),i=t(37),c=t(166),l=t(131),s=t(2),u=t(7),p=t(11),d=t.n(p),f=t(15),m=r.a.forwardRef((function(e,a){var t=e.bsPrefix,n=e.variant,o=e.pill,i=e.className,c=e.as,l=void 0===c?"span":c,p=Object(u.a)(e,["bsPrefix","variant","pill","className","as"]),m=Object(f.a)(t,"badge");return r.a.createElement(l,Object(s.a)({ref:a},p,{className:d()(i,m,o&&m+"-pill",n&&m+"-"+n)}))}));m.displayName="Badge",m.defaultProps={pill:!1};var g=m,b=t(270);a.a=function(){var e=Object(i.c)(o.f.getTournament);return r.a.createElement(c.a,null,r.a.createElement(l.a,null,r.a.createElement("h2",{className:"float-left"},r.a.createElement(g,{variant:"info"},r.a.createElement("span",null,"Torneo "),r.a.createElement("strong",null,'"',e.name.toUpperCase(),'"'),r.a.createElement("span",null,r.a.createElement("i",null," - ".concat(Object(b.b)(e.date)," "),r.a.createElement("small",null," @ ",Object(b.e)(e.progress))))))))}},361:function(e,a,t){},362:function(e,a,t){"use strict";var n=t(7),r=t(2),o=t(11),i=t.n(o),c=t(0),l=t.n(c),s=t(30),u=t(15),p=Object(s.a)("input-group-append"),d=Object(s.a)("input-group-prepend"),f=Object(s.a)("input-group-text",{Component:"span"}),m=l.a.forwardRef((function(e,a){var t=e.bsPrefix,o=e.size,c=e.className,s=e.as,p=void 0===s?"div":s,d=Object(n.a)(e,["bsPrefix","size","className","as"]);return t=Object(u.a)(t,"input-group"),l.a.createElement(p,Object(r.a)({ref:a},d,{className:i()(c,t,o&&t+"-"+o)}))}));m.displayName="InputGroup";var g=Object(r.a)({},m,{Text:f,Radio:function(e){return l.a.createElement(f,null,l.a.createElement("input",Object(r.a)({type:"radio"},e)))},Checkbox:function(e){return l.a.createElement(f,null,l.a.createElement("input",Object(r.a)({type:"checkbox"},e)))},Append:p,Prepend:d});a.a=g},372:function(e,a,t){"use strict";t.r(a);var n=t(10),r=t(13),o=t(5),i=t.n(o),c=t(20),l=t(125),s=t(0),u=t.n(s),p=t(362),d=t(274),f=t(96),m=t(166),g=t(131),b=t(283),h=t.n(b),y=t(21),v=t(37),w=t(22),E=t(58),j=function(e){var a=e.addRow,t=e.optionsLength,n=e.isEditable,r=t-1,o=r<8?8-r:0;return t?r>=8?u.a.createElement(u.a.Fragment,null,u.a.createElement("p",null," Aggiungi le coppie per questo torneo..."),u.a.createElement(f.a,{variant:"success",onClick:a,disabled:!n},"Aggiungi Coppia")):u.a.createElement(u.a.Fragment,null,u.a.createElement("p",null,"Ci sono solo ",r," giocatori definiti ma devono essercene almeno 8 per poter formare un torneo."),u.a.createElement("p",null,1===o?"Devi creare un altro giocatore...":"Devi creare almeno altri ".concat(o)),u.a.createElement(E.b,{to:"/player"},u.a.createElement(f.a,{variant:"success"},"Gestione Giocatori"))):null},O=t(130),x=t(126),C=t(278),S=t.n(C),N=t(282),k=u.a.forwardRef((function(e,a){var t=e.styles,n=e.row,r=e.columnIndex,o=(e.onUpdate,e.onSelect),i=e.options,c=Object(s.useState)(),p=Object(l.a)(c,2),d=p[0],f=p[1];return u.a.createElement(N.a,{styles:t,options:i,onChange:function(e,a){f(e),o(e,n.id,r)},getOptionLabel:function(e){return e.alias},getOptionValue:function(e){var a;return null===(a=e.id)||void 0===a?void 0:a.toString(10)},value:d,placeholder:"Cerca...",isSearchable:!0,isClearable:!0})})),P=t(88),T=function(e,a,t,n,r,o,i){return u.a.createElement(k,Object.assign({},e,{id:r,row:t,rowIndex:n,columnIndex:r,value:a,onSelect:o,options:i,styles:P.a}))},A={align:function(){return"center"},headerStyle:function(e,a){return{width:"7,5%"}},editor:{type:C.Type.CHECKBOX,value:"".concat("Si",":").concat("No")},style:function(e,a,t,n){return"No"!==e?{backgroundColor:"#ffbf47"}:null}},z=function(e,a){return[{dataField:"id",text:"ID",editable:!1,hidden:!0,align:function(){return"center"}},{dataField:"rowNumber",text:"ID",editable:!1,align:function(){return"center"}},{dataField:"player1.alias",text:"Giocatore 1",align:function(){return"center"},editorRenderer:function(t,n,r,o,i,c){return T(t,n,r,i,c,e,a)},headerStyle:function(e,a){return{width:"20%"}}},{dataField:"player2.alias",text:"Giocatore 2",align:function(){return"center"},editorRenderer:function(t,n,r,o,i,c){return T(t,n,r,i,c,e,a)},headerStyle:function(e,a){return{width:"20%"}}},{dataField:"alias",text:"Alias Coppia",headerStyle:function(e,a){return{width:"25%"}}},{dataField:"stage1Name",text:"Nome girone",align:function(){return"center"},headerStyle:function(e,a){return{width:"10%"}},editor:{type:C.Type.SELECT,options:"abcdefghijklmnopqrstuvwxyz".toUpperCase().split("").map((function(e){return{value:e,label:e}}))}},Object(n.a)({dataField:"paid1",text:"Pagato 1"},A),Object(n.a)({dataField:"paid2",text:"Pagato 2"},A)]},R=(t(361),t(273)),I=t.n(R),F=t(59),M=t(55),B=t(132),D=t(127),_=t(12),q=t(279),L={message:"",onClick:function(){return console.log("")},show:!1,title:""};a.default=Object(y.i)((function(){var e=Object(y.g)(),a=Object(v.b)(),t=Object(v.c)(M.a.isAdmin),o=Object(v.c)(B.a.getTournament),b=Object(s.useState)({state:!1,message:"Caricamento"}),E=Object(l.a)(b,2),C=E[0],N=E[1],k=Object(s.useState)(L),T=Object(l.a)(k,2),A=T[0],R=T[1],J=Object(s.useState)({rows:[],players:[]}),Z=Object(l.a)(J,2),G=Z[0],U=Z[1],H=Object(s.useState)([]),V=Object(l.a)(H,2),$=V[0],Y=V[1],K=Object(s.useState)(0),X=Object(l.a)(K,2),Q=X[0],W=X[1],ee=Object(s.useState)(0),ae=Object(l.a)(ee,2),te=ae[0],ne=ae[1];function re(e){N({state:!1,message:e}),w.b.error(e,{autoClose:1e4})}function oe(e){N({state:!1,message:e}),w.b.success(e)}function ie(e){return ce.apply(this,arguments)}function ce(){return(ce=Object(c.a)(i.a.mark((function e(a){var t,n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,N({state:!0,message:"Aggiunta riga in corso"}),(t=Object(P.c)()).tId=o.id||0,e.next=6,fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 6:return n=e.sent,e.next=9,n.json();case 9:c=e.sent,t.id=c.id,t.rowNumber=a||G.rows.length+1,U((function(e){return{rows:[t].concat(Object(r.a)(e.rows)),players:e.players}})),oe("Riga aggiunta"),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),re("Errore aggiunta riga");case 19:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}function le(){return se.apply(this,arguments)}function se(){return(se=Object(c.a)(i.a.mark((function e(){var a,t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=G.rows.length+1,t=0;case 2:if(!(t<te)){e.next=9;break}return e.next=5,ie(a);case 5:a++;case 6:t++,e.next=2;break;case 9:ne(0);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(){return pe.apply(this,arguments)}function pe(){return(pe=Object(c.a)(i.a.mark((function e(){var a,t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,N({state:!0,message:$.length>1?"Cancellazione righe in corso":"Cancellazione riga in corso"}),a=[],$.forEach((function(e){e.player1&&e.player1.id&&a.push(e.player1),e.player2&&e.player2.id&&a.push(e.player2)})),a&&U((function(e){return{rows:e.rows,players:[].concat(a,Object(r.a)(e.players)).sort((function(e,a){return e.alias.localeCompare(a.alias)}))}})),e.next=7,fetch("/api/v1/pair",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});case 7:return t=e.sent,e.next=10,t.json();case 10:U((function(e){return{rows:e.rows.filter((function(e){return!$.find((function(a){return a.id===e.id}))})),players:e.players}})),oe($.length>1?"Righe cancellate":"Riga cancellata"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),re("Errore cancellazione riga");case 17:Y([]);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function de(e,a){e&&e.id?a.id?U((function(t){return{rows:t.rows,players:[].concat(Object(r.a)(t.players.filter((function(e){return e.id!==a.id}))),[e]).sort((function(e,a){return e.alias.localeCompare(a.alias)}))}})):U((function(a){return{rows:a.rows,players:[].concat(Object(r.a)(a.players),[e]).sort((function(e,a){return e.alias.localeCompare(a.alias)}))}})):a.id&&U((function(e){return{rows:e.rows,players:e.players.filter((function(e){return e.id!==a.id}))}}))}Object(s.useEffect)((function(){o&&Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=U,e.next=3,Object(P.b)(o.id);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))()}),[o]);var fe=function(){var e=Object(c.a)(i.a.mark((function e(a,t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(G.rows.map(function(){var e=Object(c.a)(i.a.mark((function e(r){var o,c,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.id!==t){e.next=15;break}if(o=r,1===n?a.id&&o.player2&&o.player2.id===a.id?(o.player1=Object(F.c)(),re("Attenzione : Non puoi selezionare lo stesso giocare ! ")):(de(o.player1,a),o.player1=a):a.id&&o.player1&&o.player1.id===a.id?(o.player2=Object(F.c)(),re("Attenzione : Non puoi selezionare lo stesso giocare ! ")):(de(o.player2,a),o.player2=a),!(!o.alias&&o.player1&&o.player1.id&&o.player2&&o.player2.id)){e.next=11;break}return e.next=6,fetch("/api/v1/pair/alias?player1Id=".concat(encodeURIComponent(o.player1.id),"&player2Id=").concat(encodeURIComponent(o.player2.id)));case 6:return c=e.sent,e.next=9,c.json();case 9:l=e.sent,c.ok&&l.alias?o.alias=l.alias:o.alias="";case 11:return fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),e.abrupt("return",o);case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()));case 2:r=e.sent,U((function(e){return{rows:r,players:e.players}}));case 4:case"end":return e.stop()}}),e)})));return function(a,t,n){return e.apply(this,arguments)}}(),me=function(){var n=Object(c.a)(i.a.mark((function n(){var r,c,l,s,u;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o.id||(re("Id torneo mancante. Verrai inviato alla Home tra 5 secondi...."),setTimeout((function(){return e.push("/")}),5e3)),!(G.rows.length<4)){n.next=4;break}return re("Numero di coppie insufficente. Devi formare almeno 4 coppie"),n.abrupt("return");case 4:if(0===(r=G.rows.filter((function(e){return!e.stage1Name||""===e.stage1Name})).map((function(e){return e.rowNumber}))).length){n.next=8;break}return re("Assegna  ".concat(1===r.length?"la riga ":"le righe "," ").concat(r," ad un girone per procedere ")),n.abrupt("return");case 8:if(0===(c=G.rows.filter((function(e){return!e.player1||!e.player1.id||!e.player2||!e.player2.id})).map((function(e){return e.rowNumber}))).length){n.next=12;break}return re("Assegna  i giocatori ".concat(1===c.length?"alla riga ":"alle righe "," ").concat(c," per procedere ")),n.abrupt("return");case 12:for(u in 3,l=[],s=G.rows.reduce((function(e,a){return a.stage1Name in e?e[a.stage1Name]++:e[a.stage1Name]=1,e}),{}))s[u]<=3&&l.push(u);if(!(l.length>0)){n.next=19;break}return re(1===l.length?"Il torneo ".concat(l," deve contenere almeno ").concat(4," coppie"):"I torneI ".concat(l," devono contenere almeno ").concat(4," coppie")),n.abrupt("return");case 19:t&&o.progress<D.a.Stage1&&(o.progress=D.a.Stage1,a(_.g.updateTournament.request({model:o}))),a(_.a.fetchPairs.request({tId:o.id})),e.push("/stage1");case 22:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();function ge(){e.push("/")}var be={mode:"checkbox",onSelect:function(e,a){Y((function(t){var n=!!t.find((function(a){return a.id===e.id}));return a?n?t:[e].concat(Object(r.a)(t)):n?t.filter((function(a){return a.id!==e.id})):t}))},onSelectAll:function(e,a){return Y(e?a:[])},style:{backgroundColor:"#c8e6c9"},hideSelectColumn:!t||o.progress>D.a.PairsSelection},he=function(){var e=Object(c.a)(i.a.mark((function e(){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,N({state:!0,message:"Cancellazione in corso"}),e.next=4,fetch("/api/v1/stage1",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({tId:o.id})});case 4:return r=e.sent,e.next=7,r.json();case 7:t&&a(_.g.updateTournament.request({model:Object(n.a)(Object(n.a)({},o),{},{progress:D.a.PairsSelection})})),oe("Cancellazione completata"),R(L),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),re("Errore cancellazione Fase 1");case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();function ye(){o.progress>D.a.Stage1?re("Non \xe8 possibile cancellare in quanto il torneo \xe8 gia alla fase 2"):R({message:"Vuoi resettare i gironi ? ",onClick:function(){return he()},onHide:function(){return R(L)},show:!0,title:"Reset Gironi"})}function ve(){return we.apply(this,arguments)}function we(){return(we=Object(c.a)(i.a.mark((function e(){var a,t,n,r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Q){e.next=3;break}return re("Specificare il numero di gironi da assegnare"),e.abrupt("return");case 3:if(!(o.progress>D.a.PairsSelection)){e.next=6;break}return re("Non riassegnare i gironi in quanto le coppie sono gia state confermate per la fase successiva"),e.abrupt("return");case 6:for(r in N({state:!0,message:"Aggiornamento in corso "}),a=0,t="abcdefghijklmnopqrstuvwxyz".toUpperCase().split(""),n=[],G.rows){c=G.rows[r],a==Q&&(a=0),c.stage1Name=t[a],a++;try{fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),n.push(c)}catch(i){re("Errore"),n.push(c)}}oe("Gironi assegnati correttamente"),U((function(e){return{rows:n,players:e.players}}));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ee,je=Math.floor(Math.floor((G.players.length-1)/2)-(0===G.rows.length?0:G.rows.reduce((function(e,a){var t,n;return!a.player1&&!a.player2||!(null===(t=a.player1)||void 0===t?void 0:t.id)&&!(null===(n=a.player2)||void 0===n?void 0:n.id)?e+1:a.player1&&a.player1.id&&a.player2&&a.player2.id?e:e+.5}),0))),Oe=!($.length>0)||o.progress>D.a.PairsSelection;return console.log("Pairs : ",o.progress>D.a.PairsSelection,o.progress,D.a.PairsSelection),u.a.createElement("div",null,u.a.createElement(O.YesNoModal,{message:A.message,title:A.title,onClick:A.onClick,show:A.show}),u.a.createElement(O.LoadingModal,{show:C.state,message:C.message}),u.a.createElement(g.a,null,u.a.createElement("div",{className:I.a.toolsBarContainer},u.a.createElement(m.a,{className:I.a.toolsBar},u.a.createElement(g.a,null,u.a.createElement(f.a,{variant:"secondary",className:"float-left align-middle",onClick:ge},u.a.createElement(x.d,null)," Home")),o.progress>D.a.PairsSelection?null:u.a.createElement(g.a,null,u.a.createElement(f.a,{variant:"success",className:"align-middle",onClick:function(){return ie()},disabled:je<=0||!t},u.a.createElement(x.f,null)," Aggiungi Coppia")),o.progress>D.a.PairsSelection?null:u.a.createElement(g.a,null,u.a.createElement(f.a,{variant:"danger",className:"align-middle",onClick:ue,disabled:Oe||!t},u.a.createElement(x.l,null)," ",1===$.length?"Elimina coppia":"Elimina coppie")),o.progress!==D.a.Stage1?null:u.a.createElement(g.a,null,u.a.createElement(f.a,{variant:"danger",className:"align-middle",onClick:ye,disabled:!t},"Reset gironi")),u.a.createElement(g.a,null,u.a.createElement(f.a,{variant:"outline-warning",className:"default-color-white float-right align-middle",onClick:me,disabled:!t},u.a.createElement("b",null,"Prosegui ")," ",u.a.createElement(x.g,null)))),t&&o.progress<D.a.PairsSelection?u.a.createElement(u.a.Fragment,null,u.a.createElement(p.a,null,u.a.createElement(p.a.Prepend,null,u.a.createElement(p.a.Text,null,"Assegna gironi")),u.a.createElement(d.a,{placeholder:G.rows.length<4?"Inserisci almeno 4 coppie":"Numero di gironi ( max ".concat(Math.floor(G.rows.length/4)," )"),"aria-label":"Numero di gironi",type:"number",step:1,min:0,max:Math.floor(G.rows.length/4),value:0!==Q?Q:void 0,onChange:function(e){return W(Number(e.currentTarget.value))},disabled:G.rows.length<4||o.progress===D.a.Stage1||o.progress===D.a.Stage2}),u.a.createElement(p.a.Append,null,u.a.createElement(f.a,{variant:"primary",onClick:ve,disabled:!Q||Q>Math.floor(G.rows.length/4)||G.rows.length<4},"Esegui"))),u.a.createElement(p.a,null,u.a.createElement(p.a.Prepend,null,u.a.createElement(p.a.Text,null,"Aggiungi coppie")),u.a.createElement(d.a,{disabled:je<=0,type:"number",step:1,min:1,max:je,placeholder:je<=0?"Numero massimo di coppie gia creato":"Numero di coppie da aggiungere ( max ".concat(je," )"),"aria-label":"Numero di coppie",onChange:function(e){return ne(Number(e.currentTarget.value))},value:te||""}),u.a.createElement(p.a.Append,null,u.a.createElement(f.a,{variant:"primary",onClick:function(e){return ne(je)},disabled:te>je},"Max"),u.a.createElement(f.a,{variant:"primary",onClick:le,disabled:!te||te>je},"Esegui")))):null),u.a.createElement(m.a,null,u.a.createElement(g.a,null,G.rows&&G.players?u.a.createElement(h.a,{bootstrap4:!0,keyField:"id",data:G.rows,columns:z(fe,G.players),cellEdit:(Ee=t&&o.progress<D.a.Stage1,S()({mode:Ee?"click":"none",blurToSave:!0,afterSaveCell:function(e,a,t,n){"player1.alias"!==n.dataField&&"player2.alias"!==n.dataField&&Object(c.a)(i.a.mark((function e(){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return a=e.sent,e.next=5,a.json();case 5:case"end":return e.stop()}}),e)})))()}})),selectRow:be,noDataIndication:function(){return u.a.createElement(j,{isEditable:t||!1,addRow:function(){return ie()},optionsLength:G.players.length})},caption:u.a.createElement(q.a,null),headerClasses:"default-background default-color-yellow",striped:!0,hover:!0}):null))))}))}}]);
//# sourceMappingURL=6.43952b02.chunk.js.map