(this.webpackJsonpcalcetto=this.webpackJsonpcalcetto||[]).push([[8],{258:function(e,t,a){"use strict";a.d(t,"g",(function(){return l})),a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return u})),a.d(t,"f",(function(){return p})),a.d(t,"e",(function(){return d})),a.d(t,"h",(function(){return f})),a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return g}));var n=a(0),r=a.n(n),i=a(259),o=a(123),c=function(e){var t=e.size,a=e.prefix,n=e.iconName,c=e.color;return r.a.createElement(i.a,{color:c,size:t,icon:Object(o.a)({prefix:a,iconName:n})})},l=function(e){var t=e.size,a=e.color;return r.a.createElement(c,{size:t,color:a,prefix:"far",iconName:"trash-alt"})},s=function(e){var t=e.size,a=e.color;return r.a.createElement(c,{size:t,color:a,prefix:"far",iconName:"save"})},u=function(e){var t=e.size;e.color;return r.a.createElement(c,{size:t,prefix:"fas",iconName:"arrow-alt-circle-right"})},p=function(e){var t=e.size,a=e.color;return r.a.createElement(c,{size:t,color:a,prefix:"fas",iconName:"toggle-on"})},d=function(e){var t=e.size,a=e.color;return r.a.createElement(c,{size:t,color:a,prefix:"fas",iconName:"toggle-off"})},f=function(e){var t=e.size,a=e.color;return r.a.createElement(c,{size:t,color:a,prefix:"fas",iconName:"trophy"})},m=function(e){var t=e.size,a=e.color;return r.a.createElement(c,{size:t,color:a,prefix:"fas",iconName:"angle-double-right"})},g=function(e){var t=e.size,a=e.color;return r.a.createElement(c,{size:t,color:a,prefix:"fas",iconName:"ban"})}},260:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n={isLoading:function(e){var t=e.tournamentState.isLoading;return t},getTournament:function(e){return e.tournamentState.tournament},getTournamentsList:function(e){return e.tournamentState.tournamentsList}}},279:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"c",(function(){return f}));a(7),a(30),a(23),a(0),a(101);var n,r,i,o,c,l,s=a(277),u=a(263),p=(a(63),{Portiere:"Portiere",Attaccante:"Attaccante",Master:"Master"});function d(){n(""),r(""),i(""),o(""),c(""),l("")}t.b=function(e){return[{dataField:"id",text:"ID",editable:!1,headerStyle:function(e,t){return{width:"3%"}}},{dataField:"name",text:"Nome",headerClasses:"player-table-header-element",autoSelectText:!0,headerStyle:function(t,a){return{width:e?"16%":"25%"}},filter:Object(s.textFilter)({placeholder:"Filtra...",getFilter:function(e){return n=e}})},{dataField:"surname",text:"Cognome",headerClasses:"player-table-header-element",autoSelectText:!0,headerStyle:function(t,a){return{width:e?"16%":"25%"}},filter:Object(s.textFilter)({placeholder:"Filtra...",getFilter:function(e){return r=e}})},{dataField:"alias",text:"Alias",headerClasses:"player-table-header-element",headerStyle:function(t,a){return{width:e?"17%":"25%"}},autoSelectText:!0,filter:Object(s.textFilter)({placeholder:"Filtra...",getFilter:function(e){return i=e}})},{dataField:"role",text:"Roulo",headerClasses:"player-table-header-element",headerStyle:function(t,a){return{width:"".concat(e?"11":"15","%")}},filter:Object(s.selectFilter)({placeholder:"Filtra...",options:p,getFilter:function(e){return o=e}}),editor:{type:u.Type.SELECT,getOptions:function(e){return[{value:"Portiere",label:"Portiere"},{value:"Attaccante",label:"Attaccante"},{value:"Master",label:"Master"}]}}},{dataField:"email",text:"Email",headerStyle:function(e,t){return{width:"20%"}},headerClasses:"player-table-header-element",autoSelectText:!0,hidden:!e,filter:Object(s.textFilter)({placeholder:"Filtra...",getFilter:function(e){return c=e}})},{dataField:"phone",headerStyle:function(e,t){return{width:"10%"}},text:"Telefono",headerClasses:"player-table-header-element",autoSelectText:!0,hidden:!e,filter:Object(s.textFilter)({placeholder:"Filtra...",getFilter:function(e){return l=e}})},{dataField:"match_played",text:"Partite Giocate",hidden:!0},{dataField:"match_won",text:"Vittorie",hidden:!0},{dataField:"total_score",text:"Punteggio",hidden:!0}]};function f(e){return e?e.alias?e.alias:e.surname?"".concat(e.name," - ").concat(e.surname):e.name:""}},351:function(e,t,a){},365:function(e,t,a){"use strict";a.r(t);var n=a(30),r=a(7),i=a.n(r),o=a(23),c=a(122),l=a(0),s=a.n(l),u=a(158),p=a(126),d=a(352),f=a(264),m=a(101),g=a(358),h=a(367),y=a(359),b=a(272),v=a.n(b),w=a(127),E=a(18),x=a(102),S=a(29),O=a(260),j=function(){var e=Object(S.d)(O.a.getTournament);return e?s.a.createElement("h3",null,s.a.createElement("p",null,s.a.createElement("b",null,'"',s.a.createElement("strong",null,null===e||void 0===e?void 0:e.name.toUpperCase()),'"',s.a.createElement("small",null," @ ",Object(x.f)(e.progress))))):null},C=a(54),N=function(e){var t=e.addRow,a=e.optionsLength,n=e.isEditable,r=a-1,i=r<8?8-r:0;return a?r>=8?s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null," Aggiungi le coppie per questo torneo..."),s.a.createElement(m.a,{variant:"success",onClick:t,disabled:!n},"Aggiungi Coppia")):s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,"Ci sono solo ",r," giocatori definiti ma devono essercene almeno 8 per poter formare un torneo."),s.a.createElement("p",null,1===i?"Devi creare un altro giocatore...":"Devi creare almeno altri ".concat(i)),s.a.createElement(C.b,{to:"/player"},s.a.createElement(m.a,{variant:"success"},"Gestione Giocatori"))):null},k=a(124),F=(a(351),a(258)),T=a(59),z=a(63),A=a(263),I=a.n(A),P=a(271),M=a(279),R=s.a.forwardRef((function(e,t){var a=e.styles,n=e.row,r=e.columnIndex,i=e.onUpdate,o=e.onSelect,u=e.options,p=Object(l.useState)(),d=Object(c.a)(p,2),f=d[0],m=d[1];return s.a.createElement(P.a,{styles:a,options:u,onChange:function(e,t){m(e);var a=Object(M.c)(e);i(a),o(e,n.id,r)},value:f,placeholder:"Cerca...",isSearchable:!0,isClearable:!0})})),L=function(e,t){return[{dataField:"id",text:"ID",editable:!1,hidden:!0,align:function(){return"center"}},{dataField:"rowNumber",text:"ID",editable:!1,align:function(){return"center"}},{dataField:"player1.alias",text:"Giocatore 1",align:function(){return"center"},editorRenderer:function(a,n,r,i,o,c){return s.a.createElement(R,Object.assign({},a,{id:c,row:r,rowIndex:o,columnIndex:c,value:n,onSelect:e,options:t,styles:w.a}))},headerStyle:function(e,t){return{width:"20%"}}},{dataField:"player2.alias",text:"Giocatore 2",align:function(){return"center"},editorRenderer:function(a,n,r,i,o,c){return s.a.createElement(R,Object.assign({},a,{id:c,row:r,rowIndex:o,columnIndex:c,value:n,onSelect:e,options:t,styles:w.a}))},headerStyle:function(e,t){return{width:"20%"}}},{dataField:"alias",text:"Alias Coppia",headerStyle:function(e,t){return{width:"25%"}}},{dataField:"stage1Name",text:"Nome girone",align:function(){return"center"},headerStyle:function(e,t){return{width:"10%"}},editor:{type:A.Type.SELECT,options:"abcdefghijklmnopqrstuvwxyz".toUpperCase().split("").map((function(e){return{value:e,label:e}}))}},{dataField:"paid1",text:"Pagato 1",align:function(){return"center"},headerStyle:function(e,t){return{width:"7,5%"}},editor:{type:A.Type.CHECKBOX,value:"Si:No"},style:function(e,t,a,n){if("Si"!==e)return{backgroundColor:"#ffbf47"}}},{dataField:"paid2",text:"Pagato 2",align:function(){return"center"},headerStyle:function(e,t){return{width:"7,5%"}},editor:{type:A.Type.CHECKBOX,value:"Si:No"},style:function(e,t,a,n){if("Si"!==e)return{backgroundColor:"#ffbf47"}}}]},D=a(43),G=a(17),J={message:"",onClick:function(){return console.log("")},show:!1,title:""};t.default=Object(E.i)((function(){var e=Object(E.g)(),t=Object(S.c)(),a=Object(S.d)(D.a.getSession),r=Object(S.d)(O.a.getTournament),b=Object(l.useState)({state:!1,message:"Caricamento"}),x=Object(c.a)(b,2),C=x[0],A=x[1],P={message:"",type:"success"},M=Object(l.useState)(P),R=Object(c.a)(M,2),q=R[0],H=R[1],U=Object(l.useState)(J),V=Object(c.a)(U,2),_=V[0],B=V[1],K=Object(l.useState)({rows:[],players:[]}),X=Object(c.a)(K,2),W=X[0],Y=X[1],Q=Object(l.useState)([]),Z=Object(c.a)(Q,2),$=Z[0],ee=Z[1],te=Object(l.useState)(0),ae=Object(c.a)(te,2),ne=ae[0],re=ae[1],ie=Object(l.useState)(0),oe=Object(c.a)(ie,2),ce=oe[0],le=oe[1];function se(e){A({state:!1,message:e}),H({message:e,type:"danger"}),setTimeout((function(){return H(P)}),5e3)}function ue(e){A({state:!1,message:e}),H({message:e,type:"success"}),setTimeout((function(){return H(P)}),5e3)}function pe(e){return de.apply(this,arguments)}function de(){return(de=Object(o.a)(i.a.mark((function e(t){var a,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,A({state:!0,message:"Aggiunta riga in corso"}),(a=Object(w.d)()).tId=r.id||0,e.next=6,fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 6:return o=e.sent,e.next=9,o.json();case 9:c=e.sent,a.id=c.id,a.rowNumber=t||W.rows.length+1,Y((function(e){return{rows:[a].concat(Object(n.a)(e.rows)),players:e.players}})),ue("Riga aggiunta"),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),se("Errore aggiunta riga");case 19:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}function fe(){return(fe=Object(o.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=W.rows.length+1,a=0;case 2:if(!(a<ce)){e.next=9;break}return e.next=5,pe(t);case 5:t++;case 6:a++,e.next=2;break;case 9:le(0);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(){return(me=Object(o.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,A({state:!0,message:$.length>1?"Cancellazione righe in corso":"Cancellazione riga in corso"}),t=[],$.forEach((function(e){e.player1&&e.player1.id&&t.push(e.player1),e.player2&&e.player2.id&&t.push(e.player2)})),t&&Y((function(e){return{rows:e.rows,players:[].concat(t,Object(n.a)(e.players)).sort((function(e,t){return e.alias.localeCompare(t.alias)}))}})),e.next=7,fetch("/api/v1/pair",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});case 7:return a=e.sent,e.next=10,a.json();case 10:Y((function(e){return{rows:e.rows.filter((function(e){return!$.find((function(t){return t.id===e.id}))})),players:e.players}})),ue($.length>1?"Righe cancellate":"Riga cancellata"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),se("Errore cancellazione riga");case 17:ee([]);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function ge(e,t){e&&e.id?t.id?Y((function(a){return{rows:a.rows,players:[].concat(Object(n.a)(a.players.filter((function(e){return e.id!==t.id}))),[e]).sort((function(e,t){return e.alias.localeCompare(t.alias)}))}})):Y((function(t){return{rows:t.rows,players:[].concat(Object(n.a)(t.players),[e]).sort((function(e,t){return e.alias.localeCompare(t.alias)}))}})):t.id&&Y((function(e){return{rows:e.rows,players:e.players.filter((function(e){return e.id!==t.id}))}}))}Object(l.useEffect)((function(){r&&Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Y,e.next=3,Object(w.b)(r.id);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))()}),[r]);var he=function(){var n=Object(o.a)(i.a.mark((function n(){var o,c,l,s,u;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r.id||(se("Id torneo mancante. Verrai inviato alla Home tra 5 secondi...."),setTimeout((function(){return e.push("/")}),5e3)),!(W.rows.length<4)){n.next=4;break}return se("Numero di coppie insufficente. Devi formare almeno 4 coppie"),n.abrupt("return");case 4:if(0===(o=W.rows.filter((function(e){return!e.stage1Name||""===e.stage1Name})).map((function(e){return e.rowNumber}))).length){n.next=8;break}return se("Assegna  ".concat(1===o.length?"la riga ":"le righe "," ").concat(o," ad un girone per procedere ")),n.abrupt("return");case 8:if(0===(c=W.rows.filter((function(e){return!e.player1||!e.player1.id||!e.player2||!e.player2.id})).map((function(e){return e.rowNumber}))).length){n.next=12;break}return se("Assegna  i giocatori ".concat(1===c.length?"alla riga ":"alle righe "," ").concat(c," per procedere ")),n.abrupt("return");case 12:for(u in 3,l=[],s=W.rows.reduce((function(e,t){return t.stage1Name in e?e[t.stage1Name]++:e[t.stage1Name]=1,e}),{}))s[u]<=3&&l.push(u);if(!(l.length>0)){n.next=19;break}return se(1===l.length?"Il torneo ".concat(l," deve contenere almeno ").concat(4," coppie"):"I torneI ".concat(l," devono contenere almeno ").concat(4," coppie")),n.abrupt("return");case 19:a.isAdmin&&r.progress<T.a.Stage1&&(r.progress=T.a.Stage1,t(G.e.updateTournament.request({model:r}))),e.push("/stage1");case 21:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();var ye={mode:"checkbox",onSelect:function(e,t){ee((function(a){var r=!!a.find((function(t){return t.id===e.id}));return t?r?a:[e].concat(Object(n.a)(a)):r?a.filter((function(t){return t.id!==e.id})):a}))},onSelectAll:function(e,t){return ee(e?t:[])},style:{backgroundColor:"#c8e6c9"}},be=function(){var e=Object(o.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,A({state:!0,message:"Cancellazione in corso"}),e.next=4,fetch("/api/v1/stage1",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({tId:r.id})});case 4:return n=e.sent,e.next=7,n.json();case 7:a.isAdmin&&r.progress<T.a.Stage1&&(r.progress=T.a.PairsSelection,t(G.e.updateTournament.request({model:r}))),ue("Cancellazione completata"),B(J),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),se("Errore cancellazione Fase 1");case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();function ve(){return(ve=Object(o.a)(i.a.mark((function e(){var t,a,n,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ne){e.next=3;break}return se("Specificare il numero di gironi da assegnare"),e.abrupt("return");case 3:if(r.progress!==T.a.Stage1&&r.progress!==T.a.Stage2){e.next=6;break}return se("Non riassegnare i gironi in quanto le coppie sono gia state confermate per la fase successiva"),e.abrupt("return");case 6:for(o in A({state:!0,message:"Aggiornamento in corso "}),t=0,a="abcdefghijklmnopqrstuvwxyz".toUpperCase().split(""),n=[],W.rows){c=W.rows[o],t==ne&&(t=0),c.stage1Name=a[t],t++;try{fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),n.push(c)}catch(i){se("Errore"),n.push(c)}}ue("Gironi assegnati correttamente"),Y((function(e){return{rows:n,players:e.players}}));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var we,Ee=Math.floor(Math.floor((W.players.length-1)/2)-(0===W.rows.length?0:W.rows.reduce((function(e,t){var a,n;return!t.player1&&!t.player2||!(null===(a=t.player1)||void 0===a?void 0:a.id)&&!(null===(n=t.player2)||void 0===n?void 0:n.id)?e+1:t.player1&&t.player1.id&&t.player2&&t.player2.id?e:e+.5}),0))),xe=!($.length>0)||"Stage1"===r.progress||"Stage2"===r.progress,Se="";return Se=$.length>0?"Stage1"===r.progress||"Stage2"===r.progress?"Devi prima resettare i gironi per poter cancellare delle coppie":"Cancella le coppie selezionate":"Seleziona almeno una riga",s.a.createElement(u.a,null,s.a.createElement(k.YesNoModal,{message:_.message,title:_.title,onClick:_.onClick,show:_.show}),s.a.createElement(k.LoadingModal,{show:C.state,message:C.message}),s.a.createElement(p.a,{md:"10",sm:"12"},a.isAdmin?s.a.createElement(u.a,{style:{margin:"0px"}},s.a.createElement(p.a,{md:"6",sm:"12"},s.a.createElement(d.a,null,s.a.createElement(d.a.Prepend,null,s.a.createElement(d.a.Text,null,"Assegna gironi automaticamente")),s.a.createElement(f.a,{placeholder:W.rows.length<4?"Inserisci almeno 4 coppie":"Numero di gironi ( max ".concat(Math.floor(W.rows.length/4)," )"),"aria-label":"Numero di gironi",type:"number",step:1,min:0,max:Math.floor(W.rows.length/4),value:ne,onChange:function(e){return re(Number(e.currentTarget.value))},disabled:W.rows.length<4||r.progress===T.a.Stage1||r.progress===T.a.Stage2}),s.a.createElement(d.a.Append,null,s.a.createElement(m.a,{variant:"primary",onClick:function(){return ve.apply(this,arguments)},disabled:!ne||ne>Math.floor(W.rows.length/4)||W.rows.length<4},"Esegui")))),s.a.createElement(p.a,{md:"6",sm:"12"},s.a.createElement(d.a,null,s.a.createElement(d.a.Prepend,null,s.a.createElement(d.a.Text,null,"Aggiungi coppie")),s.a.createElement(f.a,{disabled:Ee<=0,type:"number",step:1,min:1,max:Ee,placeholder:Ee<=0?"Numero massimo di coppie gia creato":"Numero di coppie da aggiungere ( max ".concat(Ee," )"),"aria-label":"Numero di coppie",onChange:function(e){return le(Number(e.currentTarget.value))},value:ce||""}),s.a.createElement(d.a.Append,null,s.a.createElement(m.a,{variant:"primary",onClick:function(e){return le(Ee)},disabled:ce>Ee},"Max"),s.a.createElement(m.a,{variant:"primary",onClick:function(){return fe.apply(this,arguments)},disabled:!ce||ce>Ee},"Esegui"))))):null,s.a.createElement(u.a,{style:{margin:"5vh 0vh"}},s.a.createElement(p.a,{md:"2",sm:"12"},s.a.createElement(g.a,null,s.a.createElement(g.a.Item,{action:!0,variant:"secondary",onClick:function(){e.push("/")}},"Home"),s.a.createElement(g.a.Item,{action:!0,variant:"success",onClick:function(){return pe()},disabled:Ee<=0||!a.isAdmin},"Aggiungi Coppia"),s.a.createElement(h.a,{placement:"right",key:"right",overlay:s.a.createElement(y.a,{id:"tooltip-pair"},Se)},s.a.createElement("span",{className:"d-inline-block",onClick:function(){return me.apply(this,arguments)}},s.a.createElement(g.a.Item,{action:!0,variant:"danger",style:{pointerEvents:"none"},disabled:xe||!a.isAdmin},"Elimina Coppia ",xe))),s.a.createElement(g.a.Item,{action:!0,variant:"danger",onClick:function(){r.progress>T.a.Stage1?se("Non \xe8 possibile cancellare in quanto il torneo \xe8 gia alla fase 2"):B({message:"Vuoi resettare i gironi ? ",onClick:function(){return be()},onHide:function(){return B(J)},show:!0,title:"Reset Gironi"})},disabled:!a.isAdmin},"Reset gironi"))),s.a.createElement(p.a,{md:"10",sm:"12"},W.rows&&W.players?s.a.createElement(v.a,{bootstrap4:!0,keyField:"id",data:W.rows,columns:L((function(e,t,a){var n=W.rows.map((function(n){if(n.id===t){var r=n;return 1===a?e.id&&r.player2&&r.player2.id===e.id?(r.player1=Object(z.b)(),se("Attenzione : Non puoi selezionare lo stesso giocare ! ")):(ge(r.player1,e),r.player1=e):e.id&&r.player1&&r.player1.id===e.id?(r.player2=Object(z.b)(),se("Attenzione : Non puoi selezionare lo stesso giocare ! ")):(ge(r.player2,e),r.player2=e),fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),r}return n}));Y((function(e){return{rows:n,players:e.players}}))}),W.players),cellEdit:(we=a.isAdmin,I()({mode:we?"click":"none",blurToSave:!0,afterSaveCell:function(e,t,a,n){"player1.alias"!==n.dataField&&"player2.alias"!==n.dataField&&Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 2:return t=e.sent,e.next=5,t.json();case 5:case"end":return e.stop()}}),e)})))()}})),selectRow:ye,noDataIndication:function(){return s.a.createElement(N,{isEditable:a.isAdmin||!1,addRow:function(){return pe()},optionsLength:W.players.length})},caption:s.a.createElement(j,null),headerClasses:"default-background default-color-yellow",striped:!0,hover:!0}):null))),s.a.createElement(p.a,{md:"2",sm:"12"},s.a.createElement(m.a,{type:"button",onClick:he,size:"lg",variant:"outline-warning",className:"default-color-white"},s.a.createElement("span",{style:{fontSize:"larger",fontWeight:"bolder",padding:"1vw"}},"Prosegui"),s.a.createElement(F.c,{size:"lg"})),s.a.createElement(k.GenericToast,{message:q.message,type:q.type})," "))}))}}]);
//# sourceMappingURL=8.c4564182.chunk.js.map