(this.webpackJsonpcalcetto=this.webpackJsonpcalcetto||[]).push([[12],{255:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={isLoading:function(e){var t=e.tournamentState.isLoading;return t},getTournament:function(e){return e.tournamentState.tournament},getTournamentsList:function(e){return e.tournamentState.tournamentsList}}},274:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={isLoading:function(e){var t=e.stage1State.isLoading;return t},getSelectedRows:function(e){return e.stage1State.selectedRows||null},getSelectedPairs:function(e){return e.stage1State.selectedPairs}}},342:function(e,t,n){e.exports={"player-table":"style_player-table__3wHC-","player-table-header":"style_player-table-header__34AeX",functionsList:"style_functionsList__3bWhD"}},353:function(e,t,n){"use strict";n.r(t);var a=n(118),r=n(0),o=n.n(r),c=n(28),l=n(27),u=n(11),i=n.n(u),s=n(24),d=n(266),f=n.n(d),m=n(259),p=n.n(m),b=function(e){var t=e.title,n=e.saved,a={color:n?"#4feb34":void 0};return o.a.createElement("h3",null,o.a.createElement("b",{style:a},"Girone - ",o.a.createElement("strong",null,t)),n?o.a.createElement("small",null," - Salvataggio in corso..."):null)};function g(e,t){return e.total===t.total?3===e["col".concat(t.rowNumber)]||2===e["col".concat(t.rowNumber)]?-1:1:t.total-e.total}var h=n(31),v=n(58),w=n(25),O=function(e){var t,n=e.rows,c=e.columns,u=e.tableName,i=e.updateCellValue,s=e.autoOrder,d=e.updatePlacement,m=e.saved,O=Object(h.c)(),S=Object(r.useState)([]),y=Object(a.a)(S,2),N=y[0],j=y[1],E=Object(h.d)(v.a.getSession),x={mode:"checkbox",onSelect:function(e,t){console.log("handleOnSelect : ",e);var n,a=!!N.find((function(t){return t.rowNumber===e.rowNumber}));return n=t?a?N:[e].concat(Object(l.a)(N)):a?N.filter((function(t){return t.rowNumber!==e.rowNumber})):N,console.log("Selected : ",n),j(n),O(w.c.setSelectedPairs({stageName:u,rows:n})),!0},onSelectAll:function(e,t){j(e?t:[]),O(w.c.setSelectedPairs({stageName:u,rows:e?t:[]}))},style:{backgroundColor:"#c8e6c9"}};return console.log(" render : ",u,n),o.a.createElement(f.a,{bootstrap4:!0,keyField:"id",data:n,columns:c,selectRow:x,cellEdit:(t=E.isAdmin,p()({mode:t?"click":"none",blurToSave:!0,beforeSaveCell:function(e,t,a,r){r.id.startsWith("col")&&(n[parseInt(r.text)-1]["col".concat(a.rowNumber)]=function(e){if(null===e)return null;switch(parseInt(e)){case 3:return 0;case 2:return 1;case 1:return 2;case 0:return 3;default:return null}}(t))},afterSaveCell:function(e,t,a,r){if(r.id.startsWith("col")){i(e,t,a,r);var o=0;for(var c in a)c.startsWith("col")&&a[c]&&(o+=parseInt(a[c]));for(var u in n[a.rowNumber-1].total=o||0,console.log("Row : ",n[a.rowNumber-1]),o=0,n[parseInt(r.text)-1])u.startsWith("col")&&n[parseInt(r.text)-1][u]&&(o+=parseInt(n[parseInt(r.text)-1][u]));n[parseInt(r.text)-1].total=o||0,console.log("Opposite : ",n[parseInt(r.text)-1])}s&&Object(l.a)(n).sort((function(e,t){return g(e,t)})).forEach((function(e,t){return n[e.rowNumber-1].placement=t+1})),d(n)}})),noDataIndication:"Nessun dato reperito",headerClasses:"default-background default-color-yellow",caption:o.a.createElement(b,{title:u,saved:m}),striped:!0,hover:!0})},S=function(e,t){return{id:"col".concat(e),dataField:"col".concat(e),text:e.toString(),headerStyle:function(e,n){return{width:"".concat(75/t,"%")}},headerAlign:function(e,t){return"center"},editable:function(e,t,n,a){return n!==a-2},align:function(e,t,n,a){return"center"},style:function(e,t,n,a){return n===a-2?{backgroundColor:"#343a40"}:3===parseInt(e,10)||2===parseInt(e,10)?{backgroundColor:"rgb(196, 247, 160)"}:1===parseInt(e,10)||0===parseInt(e,10)?{backgroundColor:"rgb(255, 147, 147)"}:null},editor:{type:m.Type.SELECT,options:[{value:"3",label:"3"},{value:"2",label:"2"},{value:"1",label:"1"},{value:"0",label:"0"},{value:null,label:""}]}}},y=function(e){for(var t=[{id:"pairLabel",dataField:"pair.label",text:"Nome Coppia",editable:!1,headerStyle:function(e,t){return{width:"15%"}},align:function(e,t,n,a){return"center"},headerAlign:function(e,t){return"center"}},{id:"rowNumber",dataField:"rowNumber",text:"ID",editable:!1,type:"number",headerStyle:function(e,t){return{width:"5%"}},headerAlign:function(e,t){return"center"},style:function(e,t,n,a){return{backgroundColor:"#343a40",color:"#ffc107"}}}],n=0;n<e.length;n++)t.push(S(n+1,e.length));return t.push({id:"totale",dataField:"total",text:"Totale",editable:!1,type:"number",headerStyle:function(e,t){return{width:"5%"}},headerAlign:function(e,t){return"center"}},{id:"placement",dataField:"placement",text:"Posizione",editable:!0,type:"number",headerStyle:function(e,t){return{width:"5%"}},headerAlign:function(e,t){return"center"}}),t},N=function(e){var t,n,c=e.pairsList,u=e.autoOrder,d=Object(r.useState)(!1),f=Object(a.a)(d,2),m=f[0],p=f[1],b=Object(r.useState)(!1),h=Object(a.a)(b,2),v=h[0],w=h[1],S=Object(r.useState)(function(e){return e.map((function(t,n){for(var a={id:"row-".concat(t.tId,"-").concat(n),rowNumber:n+1,pair:t,total:0,placement:t.placement||0},r=1;r<=e.length;r++)a["col".concat(r)]=null;return a}))}(c)),N=Object(a.a)(S,2),j=N[0],E=N[1],x=null!==(t=null===(n=c[0])||void 0===n?void 0:n.stage1Name)&&void 0!==t?t:"Not found",I=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e){return{id:e.pair.id,placement:e.placement}})),e.next=3,fetch("/api/v1/stage1/placement",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rows:n})});case 3:return a=e.sent,e.next=6,a.json();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(s.a)(i.a.mark((function e(t,n,a,r){var o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={tId:a.pair.tId,tableName:x,score:n,pair1Id:a.pair.id,pair2Id:j[parseInt(r.text)-1].pair.id},e.next=3,fetch("/api/v1/stage1/cell",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 3:return c=e.sent,e.next=6,c.json();case 6:c.ok&&(w(!0),setTimeout((function(){return w(!1)}),3e3));case 7:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){(function(){var e=Object(s.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.next=3,fetch("/api/v1/stage1",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rows:j,stageName:x})});case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,u&&Object(l.a)(n).sort((function(e,t){return g(e,t)})).forEach((function(e,t){return n[e.rowNumber-1].placement=t+1})),E(n),p(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),o.a.createElement(o.a.Fragment,null,m?o.a.createElement("h3",null,"Caricamento girone ",o.a.createElement("b",null,x)," in corso...."):o.a.createElement(O,{autoOrder:u,rows:j,columns:y(c),tableName:x,updateCellValue:k,updatePlacement:I,saved:v}))},j=n(357),E=n(146),x=n(123),I=n(255),k=n(274),C=n(342),T=n.n(C),L=n(77),P=function(e){var t=e.title,n=e.show,a=e.onHide,r=e.component,c=e.size,l=n;return a||(a=function(){return l=!1}),o.a.createElement(L.a,{show:l,onHide:a,size:c||"lg",centered:!0},o.a.createElement(L.a.Header,{closeButton:!0},o.a.createElement(L.a.Title,null,t)),o.a.createElement(L.a.Body,null,r))};t.default=Object(c.i)((function(){var e=Object(h.d)(I.a.getTournament),t=Object(h.d)(k.a.getSelectedRows),n=Object(r.useState)([]),l=Object(a.a)(n,2),u=l[0],i=l[1],s=Object(r.useState)(!0),d=Object(a.a)(s,2),f=d[0],m=(d[1],{show:!1,message:""}),p=Object(r.useState)(m),b=Object(a.a)(p,2),g=b[0],v=b[1],w=Object(c.g)();return Object(r.useEffect)((function(){return Object(x.c)(i,e.id)}),[e.id]),o.a.createElement(o.a.Fragment,null,o.a.createElement(j.a.Item,{className:T.a.functionsList,key:"stage-button"},o.a.createElement(E.a,{variant:"secondary",onClick:function(){w.push("/tournament")}},"Gestione Coppie"),o.a.createElement(E.a,{variant:"success",className:"float-right",onClick:function(){console.log("goToStage2 : ",t),w.push("/stage2")}},"Prosegui")),o.a.createElement(P,{show:g.show,title:"Errore",onHide:function(){return v(m)},component:o.a.createElement("p",null,g.message),size:"xl"}),function(e,t){var n="",a=[],r=[];console.log("PairsList : ",e),e.sort((function(e,t){return e.stage1Name.localeCompare(t.stage1Name)})).forEach((function(e,c){""===n&&(n=e.stage1Name),n!==e.stage1Name&&(r.push(o.a.createElement(j.a.Item,{className:"inherit-background",key:"stage-".concat(n)},o.a.createElement(N,{pairsList:a,autoOrder:t}))),n=e.stage1Name,a=[]),a.push(e)})),a.length>0&&r.push(o.a.createElement(j.a.Item,{className:"inherit-background",key:"stage-".concat(n)},o.a.createElement(N,{pairsList:a,autoOrder:t})));return o.a.createElement(j.a,{variant:"flush"},r)}(u,f))}))}}]);
//# sourceMappingURL=12.fd2ab5b3.chunk.js.map