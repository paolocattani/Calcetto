(this.webpackJsonpcalcetto=this.webpackJsonpcalcetto||[]).push([[9],{1268:function(e,a,t){"use strict";var r=t(2),n=t(8),o=t(11),c=t.n(o),i=t(0),l=t.n(i),s=t(100),u=function(){},p=l.a.forwardRef((function(e,a){var t=e.children,o=e.name,p=e.className,d=e.checked,m=e.type,f=e.onChange,g=e.value,b=e.disabled,y=e.inputRef,h=Object(n.a)(e,["children","name","className","checked","type","onChange","value","disabled","inputRef"]),v=Object(i.useState)(!1),w=v[0],E=v[1],O=Object(i.useCallback)((function(e){"INPUT"===e.target.tagName&&E(!0)}),[]),j=Object(i.useCallback)((function(e){"INPUT"===e.target.tagName&&E(!1)}),[]);return l.a.createElement(s.a,Object(r.a)({},h,{ref:a,className:c()(p,w&&"focus",b&&"disabled"),type:void 0,active:!!d,as:"label"}),l.a.createElement("input",{name:o,type:m,value:g,ref:y,autoComplete:"off",checked:!!d,disabled:!!b,onFocus:O,onBlur:j,onChange:f||u}),t)}));p.displayName="ToggleButton",a.a=p},1269:function(e,a,t){},1270:function(e,a,t){"use strict";var r=t(8),n=t(2),o=t(11),c=t.n(o),i=t(0),l=t.n(i),s=t(34),u=t(14),p=Object(s.a)("input-group-append"),d=Object(s.a)("input-group-prepend"),m=Object(s.a)("input-group-text",{Component:"span"}),f=l.a.forwardRef((function(e,a){var t=e.bsPrefix,o=e.size,i=e.className,s=e.as,p=void 0===s?"div":s,d=Object(r.a)(e,["bsPrefix","size","className","as"]);return t=Object(u.a)(t,"input-group"),l.a.createElement(p,Object(n.a)({ref:a},d,{className:c()(i,t,o&&t+"-"+o)}))}));f.displayName="InputGroup";var g=Object(n.a)({},f,{Text:m,Radio:function(e){return l.a.createElement(m,null,l.a.createElement("input",Object(n.a)({type:"radio"},e)))},Checkbox:function(e){return l.a.createElement(m,null,l.a.createElement("input",Object(n.a)({type:"checkbox"},e)))},Append:p,Prepend:d});a.a=g},1283:function(e,a,t){"use strict";t.r(a);var r=t(6),n=t(13),o=t(3),c=t.n(o),i=t(19),l=t(288),s=t(0),u=t.n(s),p=t(1270),d=t(310),m=t(100),f=t(180),g=t(141),b=t(393),y=t.n(b),h=t(23),v=t(38),w=t(20),E=t(62),O=t(285),j=function(e){var a=e.addRow,t=e.optionsLength,r=e.isEditable,n=Object(O.a)(["common","pair"]).t,o=t-1,c=o<8?8-o:0;return t?o>=8?u.a.createElement(u.a.Fragment,null,u.a.createElement("p",null,"".concat(n("pair:missing.1"),"...")),u.a.createElement(m.a,{variant:"success",onClick:a,disabled:!r},n("pair:add.one"))):u.a.createElement(u.a.Fragment,null,u.a.createElement("p",null,n("pair:missing.2",{current:o,min:8})),u.a.createElement("p",null,"".concat(1===c?n("pair:missing.3"):n("pair:missing.4",{diff:c}),"...")),u.a.createElement(E.b,{to:"/player"},u.a.createElement(m.a,{variant:"success"},n("common:root.player")))):null},x=t(74),k=t(51),C=t(357),S=t.n(C),N=t(360),T=u.a.forwardRef((function(e,a){var t=e.styles,r=e.row,n=e.columnIndex,o=(e.onUpdate,e.onSelect),c=e.options,i=Object(s.useState)(),p=Object(l.a)(i,2),d=p[0],m=p[1];return u.a.createElement(N.a,{styles:t,options:c,onChange:function(e,a){m(e),o(e,r.id,n)},getOptionLabel:function(e){return e.alias},getOptionValue:function(e){var a;return null===(a=e.id)||void 0===a?void 0:a.toString(10)},value:d,placeholder:"Cerca...",isSearchable:!0,isClearable:!0})})),P=t(97),I=t(280),F=t(1268),R=function(e,a,t,r,n,o,c){return u.a.createElement(T,Object.assign({},e,{id:n,row:t,rowIndex:r,columnIndex:n,value:a,onSelect:o,options:c,styles:P.a}))},B={align:function(){return"center"},headerStyle:function(e,a){return{width:"7,5%"}},editor:{type:C.Type.CHECKBOX,value:"".concat("Si",":").concat("No")},formatter:function(e,a,t,r){return u.a.createElement(I.a,{toggle:!0,className:"mb-2"},u.a.createElement(F.a,{variant:e?"success":"danger",checked:e,value:"1",type:"checkbox"},e?"Pagato":"Non Pagato"))}},L=function(e,a,t){return[{dataField:"id",text:"ID",editable:!1,hidden:!0,align:function(){return"center"}},{dataField:"rowNumber",text:"ID",editable:!1,align:function(){return"center"}},{dataField:"player1.alias",text:t.player1,align:function(){return"center"},editorRenderer:function(t,r,n,o,c,i){return R(t,r,n,c,i,e,a)},headerStyle:function(e,a){return{width:"20%"}}},{dataField:"player2.alias",text:t.player2,align:function(){return"center"},editorRenderer:function(t,r,n,o,c,i){return R(t,r,n,c,i,e,a)},headerStyle:function(e,a){return{width:"20%"}}},{dataField:"alias",text:t.alias,headerStyle:function(e,a){return{width:"25%"}}},{dataField:"stage1Name",text:t.stage1,align:function(){return"center"},headerStyle:function(e,a){return{width:"10%"}},editor:{type:C.Type.SELECT,options:"abcdefghijklmnopqrstuvwxyz".toUpperCase().split("").map((function(e){return{value:e,label:e}}))}},Object(r.a)({dataField:"paid1",text:"Pagato 1"},B),Object(r.a)({dataField:"paid2",text:"Pagato 2"},B)]},U=(t(1269),t(321)),_=t.n(U),J=t(60),M=t(69),q=t(142),A=t(12),D=t(341),z=t(26),H={message:"",onClick:function(){return console.log("")},show:!1,title:""};a.default=Object(h.i)((function(){var e=Object(h.g)(),a=Object(v.c)(),t=Object(O.a)(["common","pair"]).t,o=Object(v.d)(M.a.isAdmin),b=Object(v.d)(q.a.getTournament),E=Object(s.useState)({state:!1,message:t("common:loading")}),C=Object(l.a)(E,2),N=C[0],T=C[1],I=Object(s.useState)(H),F=Object(l.a)(I,2),R=F[0],B=F[1],U=Object(s.useState)({rows:[],players:[]}),G=Object(l.a)(U,2),K=G[0],V=G[1],X=Object(s.useState)([]),Y=Object(l.a)(X,2),Q=Y[0],W=Y[1],Z=Object(s.useState)(0),$=Object(l.a)(Z,2),ee=$[0],ae=$[1],te=Object(s.useState)(0),re=Object(l.a)(te,2),ne=re[0],oe=re[1];function ce(e){T({state:!1,message:e}),w.b.error(e,{autoClose:1e4})}function ie(e){T({state:!1,message:e}),w.b.success(e)}function le(e){return se.apply(this,arguments)}function se(){return(se=Object(i.a)(c.a.mark((function e(a){var r,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,T({state:!0,message:t("common:loading")}),(r=Object(P.c)()).tId=b.id||0,e.next=6,fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 6:return o=e.sent,e.next=9,o.json();case 9:i=e.sent,r.id=i.id,r.rowNumber=a||K.rows.length+1,V((function(e){return{rows:[r].concat(Object(n.a)(e.rows)),players:e.players}})),ie(t("pair:success.add")),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),ce(t("pair:error.19"));case 19:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}function ue(){return pe.apply(this,arguments)}function pe(){return(pe=Object(i.a)(c.a.mark((function e(){var a,t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=K.rows.length+1,t=0;case 2:if(!(t<ne)){e.next=9;break}return e.next=5,le(a);case 5:a++;case 6:t++,e.next=2;break;case 9:oe(0);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(){return me.apply(this,arguments)}function me(){return(me=Object(i.a)(c.a.mark((function e(){var a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,T({state:!0,message:t("common:loading")}),a=[],Q.forEach((function(e){e.player1&&e.player1.id&&a.push(e.player1),e.player2&&e.player2.id&&a.push(e.player2)})),a&&V((function(e){return{rows:e.rows,players:[].concat(a,Object(n.a)(e.players)).sort((function(e,a){return e.alias.localeCompare(a.alias)}))}})),e.next=7,fetch("/api/v1/pair",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)});case 7:return r=e.sent,e.next=10,r.json();case 10:V((function(e){return{rows:e.rows.filter((function(e){return!Q.find((function(a){return a.id===e.id}))})),players:e.players}})),ie(t("pair:success.".concat(Q.length>1?"deleteMulti":"deleteOne"))),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),ce(t("pair:error.18"));case 17:W([]);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function fe(e,a){e&&e.id?a.id?V((function(t){return{rows:t.rows,players:[].concat(Object(n.a)(t.players.filter((function(e){return e.id!==a.id}))),[e]).sort((function(e,a){return e.alias.localeCompare(a.alias)}))}})):V((function(a){return{rows:a.rows,players:[].concat(Object(n.a)(a.players),[e]).sort((function(e,a){return e.alias.localeCompare(a.alias)}))}})):a.id&&V((function(e){return{rows:e.rows,players:e.players.filter((function(e){return e.id!==a.id}))}}))}Object(s.useEffect)((function(){b&&Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=V,e.next=3,Object(P.b)(b.id);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))()}),[b]);var ge=function(){var e=Object(i.a)(c.a.mark((function e(a,r,n){var o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(K.rows.map(function(){var e=Object(i.a)(c.a.mark((function e(o){var i,l,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.id!==r){e.next=15;break}if(i=o,1===n?a.id&&i.player2&&i.player2.id===a.id?(i.player1=Object(J.c)(),ce(t("pair:error.17"))):(fe(i.player1,a),i.player1=a):a.id&&i.player1&&i.player1.id===a.id?(i.player2=Object(J.c)(),ce(t("pair:error.17"))):(fe(i.player2,a),i.player2=a),!(!i.alias&&i.player1&&i.player1.id&&i.player2&&i.player2.id)){e.next=11;break}return e.next=6,fetch("/api/v1/pair/alias?player1Id=".concat(encodeURIComponent(i.player1.id),"&player2Id=").concat(encodeURIComponent(i.player2.id)));case 6:return l=e.sent,e.next=9,l.json();case 9:s=e.sent,l.ok&&s.alias?i.alias=s.alias:i.alias="";case 11:return fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),e.abrupt("return",i);case 15:return e.abrupt("return",o);case 16:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()));case 2:o=e.sent,V((function(e){return{rows:o,players:e.players}}));case 4:case"end":return e.stop()}}),e)})));return function(a,t,r){return e.apply(this,arguments)}}(),be=function(){var r=Object(i.a)(c.a.mark((function r(){var n,i,l,s,u;return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(b.id||(ce("".concat(t("pair:error.16"),"...")),setTimeout((function(){return e.push("/")}),5e3)),!(K.rows.length<4)){r.next=4;break}return ce(t("pair:error.15")),r.abrupt("return");case 4:if(0===(n=K.rows.filter((function(e){return!e.stage1Name||""===e.stage1Name})).map((function(e){return e.rowNumber}))).length){r.next=8;break}return ce(t("pair:error.".concat(1===n.length?"13":"14"),{missingStage1Name:n})),r.abrupt("return");case 8:if(0===(i=K.rows.filter((function(e){return!e.player1||!e.player1.id||!e.player2||!e.player2.id})).map((function(e){return e.rowNumber}))).length){r.next=12;break}return ce(t("pair:error.".concat(1===i.length?"11":"12"),{missingPairs:i})),r.abrupt("return");case 12:for(u in 3,l=[],s=K.rows.reduce((function(e,a){return a.stage1Name in e?e[a.stage1Name]++:e[a.stage1Name]=1,e}),{}))s[u]<=3&&l.push(u);if(!(l.length>0)){r.next=19;break}return ce(t("pair:error.".concat(1===l.length?"9":"10"),{invalidStage:l,min:4})),r.abrupt("return");case 19:o&&b.progress<z.TournamentProgress.Stage1&&(b.progress=z.TournamentProgress.Stage1,a(A.f.update.request({tournament:b}))),a(A.b.fetch.request({tId:b.id})),e.push("/stage1");case 22:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();function ye(){e.push("/")}var he={mode:"checkbox",onSelect:function(e,a){return W((function(t){var r=!!t.find((function(a){return a.id===e.id}));return a?r?t:[e].concat(Object(n.a)(t)):r?t.filter((function(a){return a.id!==e.id})):t})),!0},onSelectAll:function(e,a){return W(e?a:[])},style:{backgroundColor:"#c8e6c9"},hideSelectColumn:!o||b.progress>z.TournamentProgress.PairsSelection},ve=function(){var e=Object(i.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,T({state:!0,message:t("common:loading")}),e.next=4,fetch("/api/v1/stage1",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({tId:b.id})});case 4:return n=e.sent,e.next=7,n.json();case 7:o&&a(A.f.update.request({tournament:Object(r.a)(Object(r.a)({},b),{},{progress:z.TournamentProgress.PairsSelection})})),ie(t("pair:success.delete")),B(H),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),ce(t("pair:error.8"));case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();function we(){b.progress>z.TournamentProgress.Stage1?ce(t("pair:error.7")):B({message:"".concat(t("pair:stage1.resetConfirm")," ?"),onClick:function(){return ve()},onHide:function(){return B(H)},show:!0,title:t("pair:stage1.reset")})}function Ee(){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(i.a)(c.a.mark((function e(){var a,r,n,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ee){e.next=3;break}return ce(t("pair:error.6")),e.abrupt("return");case 3:if(!(b.progress>z.TournamentProgress.PairsSelection)){e.next=6;break}return ce(t("pair:error.5")),e.abrupt("return");case 6:for(o in T({state:!0,message:t("common:loading")}),a=0,r="abcdefghijklmnopqrstuvwxyz".toUpperCase().split(""),n=[],K.rows){i=K.rows[o],a==ee&&(a=0),i.stage1Name=r[a],a++;try{fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),n.push(i)}catch(c){ce("Errore"),n.push(i)}}ie(t("pair:success.stage1Name")),V((function(e){return{rows:n,players:e.players}}));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var je,xe=Math.floor(Math.floor((K.players.length-1)/2)-(0===K.rows.length?0:K.rows.reduce((function(e,a){var t,r;return!a.player1&&!a.player2||!(null===(t=a.player1)||void 0===t?void 0:t.id)&&!(null===(r=a.player2)||void 0===r?void 0:r.id)?e+1:a.player1&&a.player1.id&&a.player2&&a.player2.id?e:e+.5}),0))),ke=Q.length<=0||b.progress>z.TournamentProgress.PairsSelection,Ce={player1:t("pair:field.player1"),player2:t("pair:field.player2"),alias:t("pair:field.alias"),stage1:t("pair:field.stage1"),paid1:t("pair:field.paid1"),paid2:t("pair:field.paid2")};return u.a.createElement("div",null,u.a.createElement(x.YesNoModal,{message:R.message,title:R.title,onClick:R.onClick,show:R.show}),u.a.createElement(x.LoadingModal,{show:N.state,message:N.message}),u.a.createElement(g.a,null,u.a.createElement("div",{className:_.a.toolsBarContainer},u.a.createElement(f.a,{className:_.a.toolsBar},u.a.createElement(g.a,null,u.a.createElement(m.a,{variant:"secondary",className:"float-left align-middle",onClick:ye},u.a.createElement(k.f,null)," ",t("common:route.home"))),b.progress>z.TournamentProgress.PairsSelection?null:u.a.createElement(g.a,null,u.a.createElement(m.a,{variant:"success",className:"align-middle",onClick:function(){return le()},disabled:xe<=0||!o},u.a.createElement(k.k,null)," ",t("pair:add.one"))),b.progress>z.TournamentProgress.PairsSelection?null:u.a.createElement(g.a,null,u.a.createElement(m.a,{variant:"danger",className:"align-middle",onClick:de,disabled:ke||!o},u.a.createElement(k.q,null)," ",1===Q.length?t("pair:delete.one"):t("pair:delete.multi"))),b.progress!==z.TournamentProgress.Stage1?null:u.a.createElement(g.a,null,u.a.createElement(m.a,{variant:"danger",className:"align-middle",onClick:we,disabled:!o},t("stage1:reset"))),u.a.createElement(g.a,null,u.a.createElement(m.a,{variant:"outline-warning",className:"default-color-white float-right align-middle",onClick:be,disabled:!o},u.a.createElement("b",null,t("common:continue")," ")," ",u.a.createElement(k.l,null)))),o&&b.progress<z.TournamentProgress.PairsSelection?u.a.createElement(u.a.Fragment,null,u.a.createElement(p.a,null,u.a.createElement(p.a.Prepend,null,u.a.createElement(p.a.Text,null,t("pair:stage1.set"))),u.a.createElement(d.a,{placeholder:K.rows.length<4?t("pair:error.3"):t("pair:error.4",{max:Math.floor(K.rows.length/4)}),type:"number",step:1,min:0,max:Math.floor(K.rows.length/4),value:0!==ee?ee:void 0,onChange:function(e){return ae(Number(e.currentTarget.value))},disabled:K.rows.length<4||b.progress===z.TournamentProgress.Stage1||b.progress===z.TournamentProgress.Stage2}),u.a.createElement(p.a.Append,null,u.a.createElement(m.a,{variant:"primary",onClick:Ee,disabled:!ee||ee>Math.floor(K.rows.length/4)||K.rows.length<4},t("common:exec")))),u.a.createElement(p.a,null,u.a.createElement(p.a.Prepend,null,u.a.createElement(p.a.Text,null,t("pair:add.multi"))),u.a.createElement(d.a,{disabled:xe<=0,type:"number",step:1,min:1,max:xe,placeholder:xe<=0?t("pair:error.1"):t("pair:error.2",{max:xe}),onChange:function(e){return oe(Number(e.currentTarget.value))},value:ne||""}),u.a.createElement(p.a.Append,null,u.a.createElement(m.a,{variant:"primary",onClick:function(e){return oe(xe)},disabled:ne>xe},t("common:max")),u.a.createElement(m.a,{variant:"primary",onClick:ue,disabled:!ne||ne>xe},t("common:exec"))))):null),u.a.createElement(f.a,null,u.a.createElement(g.a,null,K.rows&&K.players?u.a.createElement(y.a,{bootstrap4:!0,keyField:"id",data:K.rows,columns:L(ge,K.players,Ce),cellEdit:(je=o&&b.progress<z.TournamentProgress.Stage1,S()({mode:je?"click":"none",blurToSave:!0,afterSaveCell:function(e,a,t,r){"player1.alias"!==r.dataField&&"player2.alias"!==r.dataField&&Object(i.a)(c.a.mark((function e(){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/pair",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return a=e.sent,e.next=5,a.json();case 5:case"end":return e.stop()}}),e)})))()}})),selectRow:he,noDataIndication:function(){return u.a.createElement(j,{isEditable:o||!1,addRow:function(){return le()},optionsLength:K.players.length})},caption:u.a.createElement(D.a,null),headerClasses:"default-background default-color-yellow",striped:!0,hover:!0}):null))))}))},321:function(e,a,t){e.exports={functionsList:"common_functionsList__3B3UB",toolsBarContainer:"common_toolsBarContainer__1nanA",toolsBarRow:"common_toolsBarRow__r8q12"}},341:function(e,a,t){"use strict";var r=t(0),n=t.n(r),o=t(73),c=t(38),i=t(180),l=t(141),s=t(281),u=t(138),p=t(285);a.a=function(){var e=Object(c.d)(o.f.getTournament),a=Object(p.a)(["tournament"]).t;return n.a.createElement(i.a,null,n.a.createElement(l.a,null,n.a.createElement("h2",{className:"float-left"},n.a.createElement(s.a,{variant:"info"},n.a.createElement("span",null,a("tournament:tournament")," "),n.a.createElement("strong",null,'"',e.name.toUpperCase(),'"'),n.a.createElement("span",null,n.a.createElement("i",null," - ".concat(Object(u.a)(e.date)," "),n.a.createElement("small",null," @ ",a("tournament:progress.".concat(e.progress)))))))))}}}]);
//# sourceMappingURL=9.3fd0bdcf.chunk.js.map